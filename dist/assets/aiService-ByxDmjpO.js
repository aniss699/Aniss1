const a=new Map,d=300*1e3,i=(r,e)=>`${r}_${JSON.stringify(e)}`,c=r=>{const e=a.get(r);return e&&Date.now()-e.timestamp<d?e.data:null},u=(r,e)=>{a.set(r,{data:e,timestamp:Date.now()})},n=async(r,e={})=>{const o=new AbortController,t=setTimeout(()=>o.abort(),1e4);try{const s=await fetch(`/api${r}`,{...e,signal:o.signal,headers:{"Content-Type":"application/json",...e.headers}});if(clearTimeout(t),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){throw clearTimeout(t),s instanceof Error&&s.name==="AbortError"?new Error("Request timeout"):s}},y={async analyzeWithAI(r){const e=i("/ai/analyze",r),o=c(e);if(o)return o;try{const t=await n("/ai/analyze",{method:"POST",body:JSON.stringify(r)});return u(e,t),t}catch(t){return console.error("Erreur analyse IA:",t),{qualityScore:50,improvements:["Analyseur IA temporairement indisponible"],detectedSkills:[],estimatedComplexity:"medium",price_suggested_med:1e3,delay_suggested_days:15,optimizedDescription:null}}},async quickAnalysis(r){try{const e=await fetch("/api/ai/quick-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("Erreur lors de l'analyse rapide IA:",e),e}},async optimizeBrief(r){const e=i("/ai/optimize-brief",r),o=c(e);if(o)return o;try{const t=await n("/ai/optimize-brief",{method:"POST",body:JSON.stringify(r)});return u(e,t),t}catch(t){return console.error("Erreur optimisation brief:",t),{optimizedText:r.description,improvements:["Service d'optimisation temporairement indisponible"],qualityScore:50}}},async getMarketInsights(r){const e=i(`/ai/market-insights/${r}`),o=c(e);if(o)return o;try{const t=await n(`/ai/market-insights/${r}`);return u(e,t),t}catch(t){return console.error("Erreur market insights:",t),{averagePrice:1e3,demandLevel:"medium",competitionLevel:"medium",trending:!1}}},async generateMissionSuggestions(r){try{return await n("/ai/mission-suggestions",{method:"POST",body:JSON.stringify({keywords:r})})}catch(e){return console.error("Erreur suggestions missions:",e),[]}},async priceAnalysis(r){try{const e=await fetch("/api/ai/price-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("Erreur lors de l'analyse de prix IA:",e),e}},async predictRevenue(r){try{const e=await fetch("/api/ai/predict-revenue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("Erreur lors de la prédiction de revenus:",e),e}},async detectDumping(r){try{const e=await fetch("/api/ai/detect-dumping",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("Erreur lors de la détection de dumping:",e),e}},async getBiddingGuidance(r){try{const e=await fetch("/api/ai/bidding-guidance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("Erreur lors du guidage d'enchères:",e),e}},async getMarketAnalysis(r){try{const e=await fetch("/api/ai/market-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("Erreur lors de l'analyse de marché:",e),e}},clearCache(){a.clear()},getCacheStats(){return{size:a.size,entries:Array.from(a.keys())}}},l=async()=>{try{return await(await fetch("/api/auth/demo-accounts/verify")).json()}catch(r){return console.error("Erreur vérification comptes démo:",r),{success:!1,error:"Erreur de connexion"}}};export{y as a,l as v};
