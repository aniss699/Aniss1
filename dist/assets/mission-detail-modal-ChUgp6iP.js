import{r as j,j as e}from"./ui-BcXBiFQq.js";import{u as Z}from"./useQuery-7UnT86OS.js";import{i as ie,d as I,j as le,k as ne,L as B,I as Q,B as x,v as de,f as _,D as y,l as w,m as L,n as V,V as ce,o as J,C as z,b as F,e as oe,g as me,q as xe,r as he,s as pe,X as ue,U as K,T as G,Z as ge}from"./index-CmOsK-Z3.js";import{a as E,g as je,f as T}from"./categories-Ci5EyH-Y.js";import{T as W}from"./textarea-DFoQrwIG.js";import{B as N}from"./badge-C0dt0eQY.js";import{T as be,a as fe,b as R,c as q}from"./tabs-DvF73uSV.js";import{A as ve}from"./availability-calendar-Co9Aaei6.js";import{M as Y}from"./map-pin-Dtu5iTCC.js";import{C as $}from"./calendar-bnwC_n0j.js";import{M as C}from"./message-circle-Xm2lhiLp.js";import{P as Ne}from"./phone-LdM_VFKp.js";import{C as ee}from"./clock-Hk81pCMq.js";import{A as se}from"./award-Dkq28A_q.js";import{S as te}from"./star-CLQgq_ki.js";import{C as ye}from"./circle-x-vMGEci7K.js";import{S as we}from"./smart-bid-analyzer-BHnsHAXh.js";import{C as Ce}from"./circle-alert-Bzb3dlCk.js";import{C as Se}from"./chevron-left-DvD14iSF.js";import{E as Ae}from"./eye-B3_ChBSx.js";import{E as ke}from"./euro-BTXXJzta.js";import{T as Te}from"./trending-up-BI80i5vD.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=ie("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);function Be({missionId:m,onSuccess:o}){const{user:n}=I(),[l,f]=j.useState({price:"",timeline:"",proposal:""}),a=le("/api/bids",{successMessage:"🚀 Offre envoyée avec succès !",errorContext:"Soumission d'offre",invalidateQueries:[["/api/missions",m],["/api/missions"],["/api/users",n?.id,"bids"]],onSuccess:()=>{f({price:"",timeline:"",proposal:""}),o()}}),p=ne({onSubmit:async r=>{a.mutate(r)},validateBeforeSubmit:de.validateBid}),d=r=>{if(r.preventDefault(),!n){p.handleError(new Error("Vous devez être connecté pour postuler"),"Authentification requise");return}p.handleSubmit({...l,missionId:m,providerId:n.id,providerName:n.name,price:parseFloat(l.price),rating:n.rating||"5.0"})},t=(r,h)=>{f(b=>({...b,[r]:h}))};return!n||n.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(B,{htmlFor:"price",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"💰"}),e.jsx("span",{children:"Prix proposé (€)"})]}),e.jsx(Q,{id:"price",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:l.price,onChange:r=>t("price",r.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0,"data-testid":"input-bid-price"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(B,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsx("span",{children:"Délai de livraison"})]}),e.jsx(Q,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:l.timeline,onChange:r=>t("timeline",r.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0,"data-testid":"input-bid-timeline"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(B,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📝"}),e.jsx("span",{children:"Décrivez votre proposition"})]}),e.jsx(W,{id:"proposal",placeholder:"Expliquez votre approche, votre expérience pertinente et ce que vous allez concrètement livrer pour cette mission...",value:l.proposal,onChange:r=>t("proposal",r.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0,"data-testid":"textarea-bid-proposal"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(x,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:a.isPending||p.isSubmitting,"data-testid":"button-submit-bid",children:a.isPending||p.isSubmitting?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🚀"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function Ee({providerId:m,providerName:o,isOpen:n,onClose:l}){const{toast:f}=_(),{data:a,isLoading:p}=Z({queryKey:["/api/providers",m,"profile"],enabled:!!m&&n}),d=t=>Array.from({length:5},(r,h)=>e.jsx(te,{className:`w-4 h-4 ${h<t?"text-yellow-400 fill-current":"text-gray-300"}`},h));return!n||!m?null:e.jsx(y,{open:n,onOpenChange:l,children:e.jsxs(w,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{children:e.jsx(V,{asChild:!0,children:e.jsx(ce,{children:"Profil du prestataire"})})}),e.jsx("div",{className:"p-6"}),p?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):a?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),a.location||"Localisation non spécifiée"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Membre depuis ",E(a.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:d(Math.round(parseFloat(a.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:a.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.totalProjects," projets réalisés"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.skills.map((t,r)=>e.jsx(N,{variant:"secondary",children:t},r))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(x,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${m}&name=${encodeURIComponent(o)}`},children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(x,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{f({title:"Contacter le prestataire",description:`Appelez ${o} pour discuter du projet`})},children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(x,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{f({title:"Réservation de créneau",description:`Fonctionnalité de réservation avec ${o} en cours de développement`})},children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Réserver un créneau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2"}),"Réalisations récentes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:a.portfolio.slice(0,4).map(t=>e.jsx(z,{children:e.jsxs(F,{className:"p-4",children:[t.images.length>0&&e.jsx("img",{src:t.images[0],alt:t.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(N,{variant:"outline",children:t.category}),e.jsx("span",{className:"text-xs text-gray-500",children:E(t.completedAt)})]})]})},t.id))}),a.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune réalisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Disponibilités"]}),e.jsx(z,{children:e.jsx(F,{className:"p-4",children:e.jsx(ve,{readOnly:!0,initialAvailability:a.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(se,{className:"w-5 h-5 mr-2"}),"Avis clients (",a.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:a.evaluations.map(t=>e.jsx(z,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[d(t.rating),e.jsx("span",{className:"ml-2 font-medium",children:t.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:E(t.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:t.comment}),t.photos&&t.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:t.photos.slice(0,3).map((r,h)=>e.jsx("img",{src:r,alt:`Photo ${h+1}`,className:"w-16 h-16 object-cover rounded-lg"},h))})]})},t.id))}),a.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{onClick:l,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvé"})})]})})}function De({bidId:m,bidderName:o,isOpen:n,onClose:l}){const{user:f}=I(),{toast:a}=_(),p=oe(),[d,t]=j.useState(null),[r,h]=j.useState(""),b=me({mutationFn:async c=>(await xe("POST","/api/bids/respond",c)).json(),onSuccess:()=>{p.invalidateQueries({queryKey:["/api/missions"]});const c=d==="accept"?"acceptée":d==="reject"?"déclinée":"en négociation";a({title:"Réponse envoyée !",description:`Votre réponse (${c}) a été envoyée au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre réponse "${c}" a bien été envoyée à ${o}. Un email de confirmation lui a été envoyé.`)},500),l(),t(null),h("")},onError:c=>{a({title:"Erreur",description:c.message||"Une erreur est survenue",variant:"destructive"})}}),D=c=>{if(c.preventDefault(),!d){a({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(d==="negotiate"&&!r.trim()){a({title:"Message requis",description:"Veuillez ajouter un message pour négocier",variant:"destructive"});return}b.mutate({bidId:m,status:d,message:r.trim()||null,clientResponse:d})},S=c=>{switch(c){case"accept":return`Bonjour ${o},

Nous avons le plaisir de vous informer que votre offre a été retenue pour ce projet. Nous allons procéder à la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${o},

Nous vous remercions pour votre offre. Malheureusement, nous avons décidé de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${o},

Votre offre nous intéresse. Cependant, nous aimerions discuter de certains points :

- 
- 

Êtes-vous ouvert à la négociation ?

Cordialement`}},v=c=>{t(c),h(S(c))};return e.jsx(y,{open:n,onOpenChange:l,children:e.jsxs(w,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsx(L,{children:e.jsxs(V,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(C,{className:"w-6 h-6 text-blue-500"}),"Répondre à l'offre de ",o]})}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre réponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>v("accept"),className:`p-4 rounded-xl border-2 transition-all ${d==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(he,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>v("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${d==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(C,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"Négocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>v("reject"),className:`p-4 rounded-xl border-2 transition-all ${d==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(ye,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"Décliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),d&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(B,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message à ",o]}),e.jsx(W,{id:"message",value:r,onChange:c=>h(c.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:l,className:"flex-1",disabled:b.isPending,children:"Annuler"}),e.jsx(x,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!d||b.isPending,children:b.isPending?"Envoi...":"Envoyer la réponse"})]})]})]})})}function es({missionId:m,isOpen:o,onClose:n}){const{user:l}=I(),[f,a]=j.useState("overview"),[p,d]=j.useState(null),[t,r]=j.useState(""),[h,b]=j.useState(null),[D,S]=j.useState(""),[v,c]=j.useState(!1),[M,U]=j.useState(!1),{data:i,isLoading:ae,error:P}=Z({queryKey:["mission-detail",m],queryFn:async()=>{if(!m)throw new Error("ID de mission manquant");console.log("🔍 Chargement mission ID:",m);try{const s=await fetch(`/api/missions/${m}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok){const A=await s.text();throw console.error("❌ Erreur API mission:",s.status,A),new Error(`Erreur ${s.status}: ${s.statusText}`)}const g=await s.json();return console.log("✅ Mission chargée:",g?.title||"Sans titre"),g}catch(s){throw console.error("❌ Erreur réseau mission:",s),s}},enabled:!!m&&o,retry:1,retryDelay:2e3,staleTime:3e4}),re=s=>{const g=typeof s=="string"?parseFloat(s):s;return Array.from({length:5},(A,k)=>e.jsx(te,{className:`w-3 h-3 ${k<Math.floor(g)?"text-yellow-400 fill-current":"text-gray-300"}`},k))};if(ae)return e.jsx(y,{open:o,onOpenChange:n,children:e.jsx(w,{className:"w-[95vw] max-w-lg mx-auto p-0 gap-0 bg-white",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Chargement..."})]})})})});if(P||!i)return e.jsx(y,{open:o,onOpenChange:n,children:e.jsx(w,{className:"w-[95vw] max-w-lg mx-auto p-6 gap-4 bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-50 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erreur de chargement"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:P instanceof Error?P.message:"Mission introuvable"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(x,{onClick:()=>window.location.reload(),variant:"outline",size:"sm",children:"Recharger"}),e.jsx(x,{onClick:n,size:"sm",children:"Fermer"})]})]})})});const O=je(i.category),u=i.bids?[...i.bids].sort((s,g)=>parseFloat(s.price)-parseFloat(g.price)):[],H=i.teamRequirements&&i.teamRequirements.length>0;return e.jsxs(y,{open:o,onOpenChange:n,children:[e.jsxs(w,{className:"w-[95vw] max-h-[90vh] max-w-4xl p-0 gap-0 bg-gray-50 rounded-xl flex flex-col",children:[e.jsxs(L,{className:"sr-only",children:[e.jsx(V,{children:i.title}),e.jsx(pe,{children:"Détails de la mission"})]}),e.jsxs("div",{className:"flex flex-col min-h-0 max-h-[90vh]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-purple-600 text-white relative flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 md:p-6",children:[e.jsx(x,{onClick:n,size:"sm",variant:"ghost",className:"text-white hover:bg-white/20 p-2 rounded-full md:hidden",children:e.jsx(Se,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 md:flex-none min-w-0",children:[e.jsx("h2",{className:"text-base md:text-xl font-bold leading-tight pr-2 md:pr-0 truncate",children:i.title}),e.jsxs("p",{className:"text-blue-100 text-xs md:text-sm mt-1 opacity-90 truncate",children:["Par ",i.clientName," • ",T(i.budget||"0")]})]}),e.jsx(x,{onClick:n,size:"sm",variant:"ghost",className:"text-white hover:bg-white/20 p-1.5 rounded-full","aria-label":"Fermer la modal",children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"px-3 pb-3 md:px-6 md:pb-4",children:e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 text-xs text-blue-100 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"w-3 h-3"}),e.jsxs("span",{children:[u.length," candidature",u.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:E(i.createdAt||new Date().toISOString())}),e.jsx("span",{className:"sm:hidden",children:"Créé"})]}),O&&e.jsx(N,{className:"bg-white/20 text-white border-none text-xs px-1.5 py-0.5",children:O.name})]})})]}),e.jsx("div",{className:"bg-white border-b flex-shrink-0",children:e.jsxs(be,{value:f,onValueChange:a,className:"w-full",children:[e.jsx(fe,{className:"w-full h-10 md:h-12 bg-transparent rounded-none border-none p-0",children:e.jsxs("div",{className:"flex w-full",children:[e.jsxs(R,{value:"overview",className:"flex-1 h-10 md:h-12 text-xs font-medium data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-blue-600 data-[state=active]:text-blue-600 rounded-none px-2",children:[e.jsx(J,{className:"w-3 h-3 md:w-4 md:h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Aperçu"}),e.jsx("span",{className:"sm:hidden",children:"Info"})]}),e.jsxs(R,{value:"bids",className:"flex-1 h-10 md:h-12 text-xs font-medium data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-blue-600 data-[state=active]:text-blue-600 rounded-none px-2",children:[e.jsx(K,{className:"w-3 h-3 md:w-4 md:h-4 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Offres (",u.length,")"]}),e.jsxs("span",{className:"sm:hidden",children:["(",u.length,")"]})]}),H&&e.jsxs(R,{value:"team",className:"flex-1 h-10 md:h-12 text-xs font-medium data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-blue-600 data-[state=active]:text-blue-600 rounded-none px-2",children:[e.jsx(G,{className:"w-3 h-3 md:w-4 md:h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Équipe"}),e.jsx("span",{className:"sm:hidden",children:"Team"})]})]})}),e.jsxs("div",{className:"flex-1 min-h-0",children:[e.jsx(q,{value:"overview",className:"m-0 data-[state=active]:flex data-[state=active]:flex-col",children:e.jsx("div",{className:"overflow-y-auto flex-1 scrollbar-thin scrollbar-thumb-gray-300",children:e.jsxs("div",{className:"p-3 md:p-6 space-y-3 md:space-y-4 pb-6 md:pb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 shadow-sm border",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-sm md:text-base",children:"Description du projet"}),e.jsx("p",{className:"text-gray-700 leading-relaxed text-sm md:text-base",children:i.description})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 md:p-4 border border-green-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 md:mb-2",children:[e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx(ke,{className:"w-3 h-3 md:w-4 md:h-4 text-white"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs md:text-sm",children:"Budget"})]}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-green-600",children:T(i.budget||"0")})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 md:p-4 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 md:mb-2",children:[e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(Y,{className:"w-3 h-3 md:w-4 md:h-4 text-white"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs md:text-sm",children:"Lieu"})]}),e.jsx("div",{className:"text-blue-600 font-medium text-xs md:text-base truncate",children:i.location||"Non spécifié"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 md:p-4 border border-purple-100 col-span-2 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 md:mb-2",children:[e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:e.jsx(Te,{className:"w-3 h-3 md:w-4 md:h-4 text-white"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs md:text-sm",children:"Intérêt"})]}),e.jsxs("div",{className:"text-purple-600 font-medium text-xs md:text-base",children:[u.length," candidature",u.length!==1?"s":""]})]})]}),l&&l.type==="provider"&&i.clientName!==l.name&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 md:p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(se,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Candidater à cette mission"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Soumettez votre proposition"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{onClick:()=>U(!M),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",size:"default",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Analyser avec l'IA"]}),e.jsxs(x,{onClick:()=>c(!v),className:"w-full bg-green-600 hover:bg-green-700 text-sm",size:"default",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),v?"Masquer le formulaire":"Soumettre une offre"]})]}),M&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(we,{missionTitle:i.title,missionDescription:i.description,missionBudget:parseFloat(i.budget||"0"),missionCategory:i.category,currentBid:{price:0,timeline:"",proposal:""},providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:u,onOptimizedBidGenerated:s=>{c(!0)}})}),v&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Be,{missionId:i.id,onSuccess:()=>{c(!1),U(!1)}})})]}),l&&l.type==="provider"&&i.clientName===l.name&&e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"w-4 h-4 text-white"})}),e.jsx("p",{className:"text-blue-700 font-medium text-sm",children:"Ceci est votre mission"})]})})]})})}),e.jsx(q,{value:"bids",className:"m-0 data-[state=active]:flex data-[state=active]:flex-col",children:e.jsx("div",{className:"overflow-y-auto flex-1 scrollbar-thin scrollbar-thumb-gray-300",children:e.jsx("div",{className:"p-3 md:p-6 space-y-3 md:space-y-4 pb-6 md:pb-8",children:u.length===0?e.jsxs("div",{className:"bg-white rounded-lg p-8 md:p-12 text-center shadow-sm border",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune candidature"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Les prestataires peuvent encore postuler"})]}):e.jsx("div",{className:"space-y-3",children:u.map((s,g)=>e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 shadow-sm border hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:s.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 cursor-pointer hover:text-blue-600 transition-colors text-sm md:text-base",onClick:()=>{d(s.providerId),r(s.providerName)},children:s.providerName}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex items-center",children:re(s.rating||"5.0")}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:[parseFloat(s.rating||"5.0").toFixed(1),"/5"]}),g===0&&u.length>1&&e.jsx(N,{className:"bg-green-100 text-green-700 text-xs ml-2",children:"Meilleure offre"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg md:text-xl font-bold text-green-600",children:T(s.price)}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-end mt-1",children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),s.timeline]})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4 mb-4 border-l-4 border-blue-400",children:e.jsx("p",{className:"text-gray-700 text-sm md:text-base leading-relaxed whitespace-pre-line",children:s.proposal})}),l&&i.userName===l.name&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs(x,{onClick:()=>{b(s.id),S(s.providerName)},variant:"outline",size:"sm",className:"flex items-center justify-center gap-2 text-sm",children:[e.jsx(C,{className:"w-4 h-4"}),"Répondre"]}),e.jsxs(x,{size:"sm",className:"bg-green-500 hover:bg-green-600 text-white flex items-center justify-center gap-2 text-sm",children:[e.jsx(X,{className:"w-4 h-4"}),"Accepter"]})]})]},s.id))})})})}),H&&e.jsx(q,{value:"team",className:"m-0 data-[state=active]:flex data-[state=active]:flex-col",children:e.jsxs("div",{className:"overflow-y-auto flex-1 scrollbar-thin scrollbar-thumb-gray-300",children:[e.jsx("div",{className:"p-3 md:p-6 space-y-3 md:space-y-4 pb-6 md:pb-8"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 shadow-sm border",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(G,{className:"w-5 h-5"}),"Composition de l'équipe"]}),e.jsx("div",{className:"space-y-3",children:i.teamRequirements?.map((s,g)=>e.jsxs("div",{className:"border-l-4 border-l-blue-500 bg-blue-50/50 rounded-r-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm md:text-base",children:s.role}),e.jsx("p",{className:"text-gray-600 text-xs md:text-sm",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm md:text-base font-bold text-green-600",children:T(s.budget||"0")}),e.jsxs(N,{variant:"outline",className:"text-xs",children:[s.quantity," personne",s.quantity>1?"s":""]})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-xs mb-2",children:"Compétences :"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.skills.map((A,k)=>e.jsx(N,{variant:"secondary",className:"text-xs",children:A},k))})]})]},g))})]})]})})]})]})})]})]}),e.jsx(Ee,{providerId:p,providerName:t,isOpen:!!p,onClose:()=>{d(null),r("")}}),e.jsx(De,{bidId:h,bidderName:D,isOpen:!!h,onClose:()=>{b(null),S("")}})]})}export{es as M};
