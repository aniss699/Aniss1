import{j as e,r as N}from"./ui-DaZ93cLC.js";import{u as A}from"./useQuery-ijHZiYn1.js";import{B as S}from"./badge-DSW4mHhL.js";import{C as F,a as R,b as X,U as B,c as O,d as z,L as y,I as E,B as T}from"./index-DWeSuU2Z.js";import{c as k}from"./categories-DUi1-GTl.js";import{E as P}from"./euro-_jrZmyZi.js";import{M as V}from"./map-pin-B4R7tmVj.js";import{T as _}from"./trending-up-B1c-GkzS.js";import{C as H}from"./clock-CMWDul2n.js";import{t as m,c as U,e as Y,d as q,g as I,a as K,b as Q,m as L,f as b}from"./calendar-BdcH06cu.js";import{f as W}from"./availability-calendar-SQDJyvot.js";import{M as G}from"./mission-detail-modal-CffsKjbh.js";import{S as w,a as M,b as D,c as C,d as x}from"./select-AOHIP1g6.js";import{M as J}from"./mission-matching-engine-DZzsbPuF.js";import"./vendor-D3F3s8fL.js";import"./chevron-left-BO6FvMe-.js";import"./trash-2-ByrcZ_WN.js";import"./textarea-DYsjLYsm.js";import"./lucide-react-BV37zEAC.js";import"./activity-pbLKtVHe.js";import"./hand-CSetpLTL.js";import"./award--5qsUCw1.js";import"./book-open-CDF2te8P.js";import"./calendar-CODl42pq.js";import"./chevron-up-BQSLmlUA.js";import"./circle-alert-yHd7XkWc.js";import"./circle-check-big-DZI2gNnR.js";import"./circle-x-NiO98Cch.js";import"./video-Ii6X_ctV.js";import"./eye-lgxgaqpw.js";import"./settings-Cxgvokdg.js";import"./filter-ChSDywg2.js";import"./rocket-eqgIdMP4.js";import"./heart-Cowr5cqn.js";import"./house-B8BRygh7.js";import"./lightbulb-ot8nbrdR.js";import"./loader-circle-DnzOtAgD.js";import"./trophy-NZEnJGRF.js";import"./mail-CAyE0F_K.js";import"./message-circle-Cg5qfe2L.js";import"./phone-l7lH4-NK.js";import"./refresh-cw-BV0z4V8V.js";import"./repeat-OyBmx95R.js";import"./send-khO9kWN1.js";import"./shield-Dw_mCaF_.js";import"./square-pen-UeX-9Tno.js";import"./star-CuAnFKpM.js";import"./thumbs-up-DAxnsZ73.js";import"./triangle-alert-XdWeZDNj.js";import"./wand-sparkles-k0faDWcH.js";import"./smart-bid-analyzer-Cki062fY.js";import"./index-L6kUD7G9.js";function j(s,a){const l=m(s),o=m(a),r=l.getTime()-o.getTime();return r<0?-1:r>0?1:r}function Z(s){return U(s,Date.now())}function $(s){return a=>{const o=(s?Math[s]:Math.trunc)(a);return o===0?0:o}}function ee(s,a){return+m(s)-+m(a)}function se(s){const a=m(s);return a.setHours(23,59,59,999),a}function te(s){const a=m(s);return+se(a)==+Y(a)}function re(s,a){const l=m(s),o=m(a),r=j(l,o),i=Math.abs(q(l,o));let u;if(i<1)u=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-r*i);let n=j(l,o)===-r;te(m(s))&&i===1&&j(s,o)===1&&(n=!1),u=r*(i-Number(n))}return u===0?0:u}function ae(s,a,l){const o=ee(s,a)/1e3;return $(l?.roundingMethod)(o)}function le(s,a,l){const o=K(),r=l?.locale??o.locale??Q,i=2520,u=j(s,a);if(isNaN(u))throw new RangeError("Invalid time value");const n=Object.assign({},l,{addSuffix:l?.addSuffix,comparison:u});let h,f;u>0?(h=m(a),f=m(s)):(h=m(s),f=m(a));const t=ae(f,h),c=(I(f)-I(h))/1e3,d=Math.round((t-c)/60);let g;if(d<2)return l?.includeSeconds?t<5?r.formatDistance("lessThanXSeconds",5,n):t<10?r.formatDistance("lessThanXSeconds",10,n):t<20?r.formatDistance("lessThanXSeconds",20,n):t<40?r.formatDistance("halfAMinute",0,n):t<60?r.formatDistance("lessThanXMinutes",1,n):r.formatDistance("xMinutes",1,n):d===0?r.formatDistance("lessThanXMinutes",1,n):r.formatDistance("xMinutes",d,n);if(d<45)return r.formatDistance("xMinutes",d,n);if(d<90)return r.formatDistance("aboutXHours",1,n);if(d<L){const p=Math.round(d/60);return r.formatDistance("aboutXHours",p,n)}else{if(d<i)return r.formatDistance("xDays",1,n);if(d<b){const p=Math.round(d/L);return r.formatDistance("xDays",p,n)}else if(d<b*2)return g=Math.round(d/b),r.formatDistance("aboutXMonths",g,n)}if(g=re(f,h),g<12){const p=Math.round(d/b);return r.formatDistance("xMonths",p,n)}else{const p=g%12,v=Math.trunc(g/12);return p<3?r.formatDistance("aboutXYears",v,n):p<9?r.formatDistance("overXYears",v,n):r.formatDistance("almostXYears",v+1,n)}}function ne(s,a){return le(s,Z(s),a)}function ie({mission:s,onClick:a}){const l=k.find(r=>r.id===s.category),o=s.bids.length>0?s.bids.reduce((r,i)=>r+parseFloat(i.price),0)/s.bids.length:0;return e.jsxs(F,{className:"hover:shadow-lg transition-all duration-300 cursor-pointer border-l-4 border-l-blue-500 hover:scale-[1.02] bg-white h-fit",onClick:a,children:[e.jsx(R,{className:"pb-2 pt-3",children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("h3",{className:"font-semibold text-base line-clamp-2 flex-1 leading-tight",children:s.title}),e.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[e.jsx(S,{variant:"secondary",className:"shrink-0 text-xs px-2 py-1",children:l?.name||s.category}),s.bids.length>0&&e.jsxs(S,{variant:"outline",className:"text-xs px-2 py-1",children:["ðŸ”¥ ",s.bids.length]})]})]})}),e.jsxs(X,{className:"py-1",children:[e.jsx("p",{className:"text-gray-600 line-clamp-2 mb-3 text-sm leading-relaxed",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(P,{className:"w-3 h-3 text-green-600"}),e.jsxs("span",{className:"font-medium truncate",children:[s.budget||"0","â‚¬"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(B,{className:"w-3 h-3 text-purple-600"}),e.jsxs("span",{className:"truncate",children:[s.bids.length," offre",s.bids.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(V,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"truncate",children:s.location||"Non spÃ©cifiÃ©"})]}),o>0&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(_,{className:"w-3 h-3 text-orange-600"}),e.jsxs("span",{className:"font-medium truncate",children:[Math.round(o),"â‚¬ moy"]})]})]})]}),e.jsx(O,{className:"pt-2 pb-3 border-t bg-gray-50/50",children:e.jsxs("div",{className:"flex justify-between items-center w-full text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(H,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:ne(new Date(s.createdAt),{addSuffix:!0,locale:W})})]}),e.jsx("div",{className:"text-xs font-medium text-primary truncate ml-2",children:s.clientName})]})})]})}function ns(){const{user:s}=z(),[a,l]=N.useState(null),[o,r]=N.useState(!1),[i,u]=N.useState({category:"all",budget:"all",location:"",sort:"newest"}),{data:n=[]}=A({queryKey:["/api/missions"]}),h=n.filter(t=>{if(i.category&&i.category!=="all"&&t.category!==i.category||i.location&&!t.location?.toLowerCase().includes(i.location.toLowerCase()))return!1;if(i.budget&&i.budget!=="all"){const c=parseFloat(t.budget||"0");switch(i.budget){case"0-500":return c>=0&&c<=500;case"500-2000":return c>500&&c<=2e3;case"2000-5000":return c>2e3&&c<=5e3;case"5000+":return c>5e3;default:return!0}}return!0}).sort((t,c)=>{switch(i.sort){case"newest":return new Date(c.createdAt).getTime()-new Date(t.createdAt).getTime();case"budget-high":return parseFloat(c.budget||"0")-parseFloat(t.budget||"0");case"budget-low":return parseFloat(t.budget||"0")-parseFloat(c.budget||"0");case"bids":return c.bids.length-t.bids.length;default:return 0}}),f=(t,c)=>{u(d=>({...d,[t]:c}))};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2 sm:mb-4",children:"Marketplace des Projets"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600",children:"DÃ©couvrez et soumissionnez sur les projets disponibles"})]}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-white via-blue-50/30 to-purple-50/20 rounded-3xl shadow-xl border border-blue-100/50 p-6 sm:p-8 sticky top-24 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Filtrer les projets"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"CatÃ©gorie"]}),e.jsxs(w,{value:i.category,onValueChange:t=>f("category",t),children:[e.jsx(M,{className:"bg-white/80 border-gray-200 hover:border-blue-400 transition-colors",children:e.jsx(D,{placeholder:"Toutes les catÃ©gories"})}),e.jsxs(C,{children:[e.jsx(x,{value:"all",children:"Toutes les catÃ©gories"}),k.map(t=>e.jsx(x,{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Budget"]}),e.jsxs(w,{value:i.budget,onValueChange:t=>f("budget",t),children:[e.jsx(M,{className:"bg-white/80 border-gray-200 hover:border-green-400 transition-colors",children:e.jsx(D,{placeholder:"Tous les budgets"})}),e.jsxs(C,{children:[e.jsx(x,{value:"all",children:"Tous les budgets"}),e.jsx(x,{value:"0-500",children:"0 - 500â‚¬"}),e.jsx(x,{value:"500-2000",children:"500 - 2 000â‚¬"}),e.jsx(x,{value:"2000-5000",children:"2 000 - 5 000â‚¬"}),e.jsx(x,{value:"5000+",children:"5 000â‚¬+"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Localisation"]}),e.jsx(E,{type:"text",placeholder:"Ville, rÃ©gion...",value:i.location,onChange:t=>f("location",t.target.value),className:"bg-white/80 border-gray-200 hover:border-purple-400 focus:border-purple-500 transition-colors"})]})]}),e.jsx(T,{onClick:()=>u({category:"all",budget:"all",location:"",sort:"newest"}),variant:"outline",className:"w-full border-gray-300 hover:bg-gray-50 transition-all duration-200 hover:shadow-md",children:"ðŸ”„ RÃ©initialiser les filtres"})]})}),e.jsxs("div",{className:"lg:w-3/4 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 sm:mb-0",children:["Toutes les missions (",h.length,")"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[s?.type==="provider"&&e.jsx(T,{onClick:()=>r(!o),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 w-full sm:w-auto",children:"ðŸ¤– Matching IA"}),e.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:"Trier par:"}),e.jsxs(w,{value:i.sort,onValueChange:t=>f("sort",t),children:[e.jsx(M,{className:"w-full sm:w-40",children:e.jsx(D,{})}),e.jsxs(C,{children:[e.jsx(x,{value:"newest",children:"Plus rÃ©cent"}),e.jsx(x,{value:"budget-high",children:"Budget dÃ©croissant"}),e.jsx(x,{value:"budget-low",children:"Budget croissant"}),e.jsx(x,{value:"bids",children:"Nombre d'offres"})]})]})]})]})]}),o&&s?.type==="provider"&&e.jsx("div",{className:"mb-8",children:e.jsx(J,{providerProfile:{id:s.id,skills:["React","Node.js","TypeScript","Python"],location:"Paris",rating:4.7,completedProjects:28,portfolio:[],hourlyRate:65,categories:["web-development","mobile-development"]},missions:h,onMissionRecommended:t=>{l(t.missionId),r(!1)}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[h.map(t=>e.jsx(ie,{mission:t,onClick:()=>l(t.id)},t.id)),h.length===0&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"text-gray-300 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune mission trouvÃ©e"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Essayez de modifier vos filtres"})]})]})]}),e.jsx(G,{missionId:a,isOpen:!!a,onClose:()=>l(null)})]})}export{ns as default};
