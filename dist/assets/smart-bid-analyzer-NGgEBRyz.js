import{r as N,j as e}from"./ui-BcXBiFQq.js";import{C as o,a as d,i as h,k as v,Z as ee,b as m,B as L,s as f,T as se,d as te}from"./index-3MO_kMLE.js";import{B as ae}from"./badge-BhmqYpuK.js";import{T as re}from"./textarea-GZRPdoUj.js";import{S as ne}from"./star-DxMjP1L2.js";import{T as I}from"./triangle-alert-C3w_vrhI.js";import{L as le}from"./lightbulb-BTqSbUXt.js";import{T as ie}from"./trending-up-zRDM7fCL.js";function je({missionTitle:b,missionDescription:P,missionBudget:y,missionCategory:w,currentBid:l,providerProfile:i,competitorBids:u=[],onOptimizedBidGenerated:S}){const[r,C]=N.useState(null),[M,k]=N.useState(!1),[A,R]=N.useState(!1),W=async()=>{k(!0),await new Promise(g=>setTimeout(g,2e3));const s=z(b+" "+P),t=z(l.proposal),a=E(s,t),c=u.length>0?u.reduce((g,B)=>g+B.price,0)/u.length:y,n=O(l.price,c,y),p=F(i.skills,w,i.completedProjects,i.rating),x=G(l.proposal,i),$=(a+p)/2,T=(n+K(l.timeline))/2,q=x*.4+$*.3+T*.3,J=D(q,u.length),X=Q({keywordRelevance:a,priceCompetitiveness:n,experienceMatch:p,proposal:l.proposal}),Y=U({rating:i.rating,projects:i.completedProjects,skills:i.skills,price:l.price,avgPrice:c}),_=V({keywordRelevance:a,priceCompetitiveness:n,proposal:l.proposal,timeline:l.timeline});C({overallScore:q,competitivenessScore:T,qualityScore:x,matchScore:$,winProbability:J,recommendations:X,strengths:Y,weaknesses:_,keywordRelevance:a,priceCompetitiveness:n,experienceMatch:p}),k(!1)},z=s=>{const t=["le","la","les","un","une","des","et","ou","mais","donc","or","ni","car"];return s.toLowerCase().split(/[\s,;.!?]+/).filter(a=>a.length>3&&!t.includes(a)).slice(0,10)},E=(s,t)=>{const a=s.filter(c=>t.some(n=>n.includes(c)||c.includes(n)));return Math.min(100,a.length/s.length*100)},O=(s,t,a)=>s>a?20:s<a*.3?40:s<=t*.9?90:s<=t?75:Math.max(30,70-(s-t)/t*50),F=(s,t,a,c)=>{let n=0;const p=s.filter(x=>x.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(x.toLowerCase()));return n+=p.length/Math.max(s.length,1)*40,n+=Math.min(30,a*.5),n+=c/5*30,Math.min(100,n)},G=(s,t)=>{let a=0;s.length>200&&(a+=25),s.length>500&&(a+=15);const n=["expérience","qualité","deadline","livraison","garantie","suivi"].filter(p=>s.toLowerCase().includes(p));return a+=n.length*5,a+=t.rating/5*20,a+=Math.min(20,t.completedProjects*.2),Math.min(100,a)},D=(s,t)=>{let a=s;return t>5?a*=.8:t>10?a*=.6:t<3&&(a*=1.1),Math.min(95,Math.max(5,a))},K=s=>{const t=parseInt(s);return t<=7?85:t<=14?75:t<=30?65:45},Q=s=>{const t=[];return s.keywordRelevance<60&&t.push("Incluez plus de mots-clés spécifiques à la mission dans votre proposition"),s.priceCompetitiveness<50&&t.push("Votre prix semble élevé par rapport à la concurrence, justifiez votre valeur ajoutée"),s.proposal.length<300&&t.push("Développez davantage votre proposition pour montrer votre compréhension du projet"),s.experienceMatch<70&&t.push("Mettez en avant votre expérience pertinente dans ce domaine"),t},U=s=>{const t=[];return s.rating>=4.5&&t.push("Excellente réputation client"),s.projects>50&&t.push("Grande expérience avec de nombreux projets"),s.price<s.avgPrice*.9&&t.push("Prix très compétitif"),t},V=s=>{const t=[];return s.keywordRelevance<50&&t.push("Faible correspondance avec les mots-clés de la mission"),s.priceCompetitiveness<40&&t.push("Prix potentiellement trop élevé"),s.proposal.length<200&&t.push("Proposition trop courte"),t},Z=()=>{const s=`
Bonjour,

Votre projet "${b}" correspond parfaitement à mon expertise. Avec ${i.completedProjects} projets réalisés et une note de ${i.rating}/5, je peux vous garantir une livraison de qualité.

Mon approche pour votre projet :
• Analyse détaillée de vos besoins spécifiques
• Utilisation de mes compétences en ${i.skills.join(", ")}
• Respect strict des délais convenus
• Communication régulière sur l'avancement
• Garantie satisfaction client

Je propose de réaliser ce projet pour ${Math.round(l.price*.95)}€ avec livraison sous ${l.timeline}.

Ma valeur ajoutée : expérience prouvée dans ${w}, méthodologie rigoureuse et engagement qualité.

Disponible pour échanger sur votre projet dès maintenant.

Cordialement
    `.trim();C(t=>t?{...t,optimizedProposal:s}:null),R(!0),S&&S({...l,proposal:s,price:Math.round(l.price*.95)})},j=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",H=s=>s>=80?"bg-green-100":s>=60?"bg-yellow-100":"bg-red-100";return e.jsxs(o,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(d,{children:e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:"Analyse IA de votre offre"}),e.jsxs(ae,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),"Smart Algorithm"]})]})}),e.jsxs(m,{className:"space-y-6",children:[!r&&!M&&e.jsx("div",{className:"text-center py-8",children:e.jsxs(L,{onClick:W,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Analyser mon offre avec l'IA"]})}),M&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Analyse en cours avec notre algorithme propriétaire..."})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-6 rounded-xl ${H(r.overallScore)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Score Global"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-3xl font-bold ${j(r.overallScore)}`,children:Math.round(r.overallScore)}),e.jsx("span",{className:"text-gray-500",children:"/100"})]})]}),e.jsx(f,{value:r.overallScore,className:"mb-4"}),e.jsx("div",{className:"flex items-center space-x-4 text-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"w-4 h-4 mr-1 text-blue-600"}),e.jsxs("span",{children:["Probabilité de succès: ",Math.round(r.winProbability),"%"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Qualité"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{value:r.qualityScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${j(r.qualityScore)}`,children:Math.round(r.qualityScore)})]})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Correspondance"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{value:r.matchScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${j(r.matchScore)}`,children:Math.round(r.matchScore)})]})]})}),e.jsx(o,{children:e.jsxs(m,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Compétitivité"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{value:r.competitivenessScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${j(r.competitivenessScore)}`,children:Math.round(r.competitivenessScore)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(h,{className:"flex items-center text-green-600",children:[e.jsx(te,{className:"w-5 h-5 mr-2"}),"Forces"]})}),e.jsx(m,{children:e.jsx("ul",{className:"space-y-2",children:r.strengths.map((s,t)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(ne,{className:"w-4 h-4 text-green-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:s})]},t))})})]}),e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(h,{className:"flex items-center text-orange-600",children:[e.jsx(I,{className:"w-5 h-5 mr-2"}),"Points d'amélioration"]})}),e.jsx(m,{children:e.jsx("ul",{className:"space-y-2",children:r.weaknesses.map((s,t)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(I,{className:"w-4 h-4 text-orange-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:s})]},t))})})]})]}),e.jsxs(o,{children:[e.jsx(d,{children:e.jsxs(h,{className:"flex items-center text-blue-600",children:[e.jsx(le,{className:"w-5 h-5 mr-2"}),"Recommandations IA"]})}),e.jsx(m,{children:e.jsx("ul",{className:"space-y-3",children:r.recommendations.map((s,t)=>e.jsxs("li",{className:"flex items-start p-3 bg-blue-50 rounded-lg",children:[e.jsx(ie,{className:"w-4 h-4 text-blue-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:s})]},t))})})]}),e.jsx("div",{className:"text-center",children:e.jsxs(L,{onClick:Z,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",disabled:A,children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Générer une proposition optimisée"]})}),A&&r.optimizedProposal&&e.jsxs(o,{className:"border-purple-200 bg-purple-50",children:[e.jsx(d,{children:e.jsx(h,{className:"text-purple-700",children:"Proposition Optimisée par IA"})}),e.jsxs(m,{children:[e.jsx(re,{value:r.optimizedProposal,readOnly:!0,className:"min-h-[200px] bg-white"}),e.jsx("div",{className:"mt-4 text-sm text-purple-600",children:"✨ Cette proposition a été générée pour maximiser vos chances de succès"})]})]})]})]})]})}export{je as S};
