import{r as h,j as a}from"./ui-BW6CElO3.js";import{C as x,a as W,h as $,r as k,Z as q,b as j,O as H,T as Z,U as O,B as V}from"./index-C4tHrSDC.js";import{B as u}from"./badge-B-7zMzEP.js";import{S as G}from"./star-zRFYLRW6.js";import{T as J}from"./trending-up-DY9s2JbF.js";function ae({providerProfile:r,missions:d,onMissionRecommended:b}){const[g,y]=h.useState([]),[N,p]=h.useState(!1),[Q,X]=h.useState({minMatchScore:70,maxCompetition:"high",minWinProbability:40}),M=async()=>{p(!0),await new Promise(e=>setTimeout(e,1500));const c=d.map(e=>{const s=w(e,r),n=v(e,r),o=C(e,r),l=P(e,r),m=s*.35+n*.25+o*.15+l*.25,i=S(e),f=L(m,i,r.rating,r.completedProjects),D=B(e,i,r),I=A(e),F=R(e,r,{skillsMatch:s,locationMatch:o,competitionLevel:i,winProbability:f});return{missionId:e.id,title:e.title,description:e.description,budget:e.budget,matchScore:m,reasonsToApply:F,competitionLevel:i,winProbability:f,recommendedBidPrice:D,skillsMatch:s,experienceMatch:n,locationMatch:o,urgency:I,clientProfile:{name:e.clientName,rating:4.2+Math.random()*.8,projectsPosted:Math.floor(Math.random()*20)+1,avgBudget:e.budget*(.8+Math.random()*.4)}}}).sort((e,s)=>s.matchScore-e.matchScore).slice(0,10);y(c),p(!1)},w=(t,c)=>{const e=T(t),s=c.skills.map(l=>l.toLowerCase());let n=0,o=e.length;return e.forEach(l=>{s.some(i=>i.includes(l)||l.includes(i)||U(l,i)>.7)&&n++}),Math.min(100,n/Math.max(o,1)*100)},v=(t,c)=>{let e=0;return c.completedProjects>=50?e+=40:c.completedProjects>=20?e+=30:c.completedProjects>=5?e+=20:e+=10,c.categories.includes(t.category)&&(e+=30),e+=c.rating/5*30,Math.min(100,e)},C=(t,c)=>{if(!t.location||!c.location)return 70;const e=t.location.toLowerCase(),s=c.location.toLowerCase();if(e===s)return 100;if(e.includes(s)||s.includes(e))return 85;const n=Math.random()*500;return n<50?90:n<100?75:n<200?60:40},P=(t,c)=>{const e=t.budget,s=c.hourlyRate,n=e/s;return n>=20&&n<=100?100:n>=10&&n<=150?80:n>=5&&n<=200?60:40},S=t=>{const c=t.bids?.length||0,e=Math.floor((Date.now()-new Date(t.createdAt).getTime())/(1e3*60*60*24));return c>10||e>7?"high":c>5||e>3?"medium":"low"},L=(t,c,e,s)=>{let n=t;return c==="low"?n*=1.3:c==="high"&&(n*=.7),n+=e/5*10,n+=Math.min(15,s*.2),Math.min(95,Math.max(5,n))},B=(t,c,e)=>{let n=t.budget;return c==="high"?n*=.85:c==="low"?n*=.95:n*=.9,e.rating>=4.5&&e.completedMissions>=20&&(n*=1.05),Math.round(n)},A=t=>{if(["urgent","asap","rapidement","immédiat","express"].some(n=>t.title.toLowerCase().includes(n)||t.description.toLowerCase().includes(n)))return"high";const s=Math.floor((Date.now()-new Date(t.createdAt).getTime())/(1e3*60*60*24));return s<=1?"high":s<=3?"medium":"low"},R=(t,c,e)=>{const s=[];return e.skillsMatch>=80&&s.push("Parfaite correspondance avec vos compétences"),e.competitionLevel==="low"&&s.push("Faible concurrence - grande chance de succès"),e.winProbability>=70&&s.push(`${Math.round(e.winProbability)}% de probabilité de gagner`),t.budget>=c.hourlyRate*20&&s.push("Budget attractif pour ce type de projet"),e.locationMatch>=90&&s.push("Client dans votre zone géographique"),s.slice(0,3)},T=t=>{const c=(t.title+" "+t.description+" "+t.category).toLowerCase(),e=["le","la","les","un","une","des","et","ou","mais","donc"];return c.split(/[\s,;.!?]+/).filter(s=>s.length>3&&!e.includes(s)).slice(0,10)},U=(t,c)=>{const e=t.length>c.length?t:c,s=t.length>c.length?c:t;if(e.length===0)return 1;const n=E(e,s);return(e.length-n)/e.length},E=(t,c)=>{const e=[];for(let s=0;s<=c.length;s++)e[s]=[s];for(let s=0;s<=t.length;s++)e[0][s]=s;for(let s=1;s<=c.length;s++)for(let n=1;n<=t.length;n++)c.charAt(s-1)===t.charAt(n-1)?e[s][n]=e[s-1][n-1]:e[s][n]=Math.min(e[s-1][n-1]+1,e[s][n-1]+1,e[s-1][n]+1);return e[c.length][t.length]},K=t=>{switch(t){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},z=t=>{switch(t){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return h.useEffect(()=>{d.length>0&&M()},[d,r]),a.jsxs("div",{className:"space-y-6",children:[a.jsx(x,{children:a.jsx(W,{children:a.jsxs($,{className:"flex items-center space-x-2",children:[a.jsx(k,{className:"w-6 h-6 text-purple-600"}),a.jsx("span",{children:"Moteur de Matching IA"}),a.jsxs(u,{variant:"secondary",className:"bg-purple-100 text-purple-700",children:[a.jsx(q,{className:"w-3 h-3 mr-1"}),"Algorithm v2.0"]})]})})}),N?a.jsx(x,{children:a.jsxs(j,{className:"py-12 text-center",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"}),a.jsxs("p",{className:"text-gray-600",children:["Analyse de ",d.length," missions avec notre IA..."]})]})}):a.jsx("div",{className:"space-y-4",children:g.map((t,c)=>a.jsx(x,{className:"hover:shadow-lg transition-shadow",children:a.jsxs(j,{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold",children:t.title}),a.jsxs(u,{className:`px-2 py-1 text-xs ${K(t.competitionLevel)}`,children:["Concurrence ",t.competitionLevel]}),a.jsx(u,{className:`px-2 py-1 text-xs ${z(t.urgency)}`,children:t.urgency==="high"?"Urgent":t.urgency==="medium"?"Normal":"Pas pressé"})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[t.budget,"€"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Prix suggéré: ",t.recommendedBidPrice,"€"]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium",children:"Score de correspondance"}),a.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[Math.round(t.matchScore),"%"]})]}),a.jsx(H,{value:t.matchScore,className:"mb-2"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-gray-600",children:[a.jsxs("div",{children:["Compétences: ",Math.round(t.skillsMatch),"%"]}),a.jsxs("div",{children:["Expérience: ",Math.round(t.experienceMatch),"%"]}),a.jsxs("div",{children:["Localisation: ",Math.round(t.locationMatch),"%"]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center",children:[a.jsx(Z,{className:"w-4 h-4 mr-1 text-blue-600"}),"Pourquoi postuler"]}),a.jsx("ul",{className:"space-y-1",children:t.reasonsToApply.map((e,s)=>a.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"•"}),e]},s))})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{className:"w-4 h-4 mr-1"}),t.clientProfile.name]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(G,{className:"w-4 h-4 mr-1 text-yellow-500"}),t.clientProfile.rating.toFixed(1)]}),a.jsxs("div",{children:[t.clientProfile.projectsPosted," projets postés"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(J,{className:"w-4 h-4 text-green-500"}),a.jsxs("span",{className:"font-medium",children:[Math.round(t.winProbability),"% de succès"]})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:["Rang #",c+1," sur ",g.length]}),a.jsx(V,{onClick:()=>b?.(t),className:"bg-purple-600 hover:bg-purple-700",children:"Voir la mission"})]})]})},t.missionId))})]})}export{ae as M};
