import{r as j,j as e}from"./ui-BW6CElO3.js";import{u as _}from"./useQuery-C0UJuidT.js";import{d as I,f as V,e as J,g as W,i as Y,L as E,I as G,B as h,D as w,j as C,k as U,l as L,V as de,m as ee,C as F,b as M,n as ce,X as oe,U as H,T as X,Z as me}from"./index-BNYRtrLK.js";import{a as D,g as xe,f as k}from"./categories-Ci5EyH-Y.js";import{T as se}from"./textarea-CJXJlNeD.js";import{B as N}from"./badge-D57D_Qfi.js";import{T as he,a as pe,b as q,c as R}from"./tabs-DbLZOosT.js";import{A as ue}from"./availability-calendar-DKsC1D1k.js";import{M as te}from"./map-pin-CkwkiVao.js";import{C as $}from"./calendar-C7WxELBG.js";import{M as S}from"./message-circle-CVIIXDQF.js";import{P as ge}from"./phone-CNSaJZ22.js";import{C as re}from"./clock-bN_puvL-.js";import{A as ae}from"./award-DmZRau_H.js";import{S as ie}from"./star-C1rzmK3m.js";import{C as je}from"./circle-check-big-4ZYIb0qk.js";import{C as fe}from"./circle-x-W5PMLOUN.js";import{S as be}from"./smart-bid-analyzer-CzmmalkG.js";import{C as ve}from"./circle-alert-SEm80Jx-.js";import{C as Ne}from"./chevron-left-Cxmn0SqK.js";import{E as ye}from"./eye-Ci3ayMFl.js";import{E as we}from"./euro-kIzuyLMs.js";import{T as Ce}from"./trending-up-CxkzcC5h.js";import{U as Z}from"./user-check-Od-HZeSf.js";function Se({missionId:m,onSuccess:o}){const{user:n}=I(),{toast:d}=V(),f=J(),[t,b]=j.useState({price:"",timeline:"",proposal:""}),l=W({mutationFn:async a=>(await Y("POST","/api/bids",a)).json(),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/missions",m]}),f.invalidateQueries({queryKey:["/api/missions"]}),f.invalidateQueries({queryKey:["/api/users",n?.id,"bids"]}),d({title:"Offre envoyée !",description:"Votre offre a été envoyée avec succès"}),b({price:"",timeline:"",proposal:""}),o()},onError:a=>{d({title:"Erreur",description:a.message||"Une erreur est survenue",variant:"destructive"})}}),r=a=>{if(a.preventDefault(),!t.price||!t.timeline||!t.proposal){d({title:"Champs requis",description:"Veuillez remplir tous les champs",variant:"destructive"});return}if(!n){d({title:"Connexion requise",description:"Vous devez être connecté pour postuler",variant:"destructive"});return}l.mutate({missionId:m,providerId:n.id,providerName:n.name,price:parseFloat(t.price),timeline:t.timeline,proposal:t.proposal,rating:n.rating||"5.0"})},x=(a,p)=>{b(y=>({...y,[a]:p}))};return!n||n.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"price",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"💰"}),e.jsx("span",{children:"Prix proposé (€)"})]}),e.jsx(G,{id:"price",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:t.price,onChange:a=>x("price",a.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsx("span",{children:"Délai de livraison"})]}),e.jsx(G,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:t.timeline,onChange:a=>x("timeline",a.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📝"}),e.jsx("span",{children:"Décrivez votre proposition"})]}),e.jsx(se,{id:"proposal",placeholder:"Expliquez votre approche, votre expérience pertinente et ce que vous allez concrètement livrer pour cette mission...",value:t.proposal,onChange:a=>x("proposal",a.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx(h,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:l.isPending,children:l.isPending?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🚀"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function Ae({providerId:m,providerName:o,isOpen:n,onClose:d}){const{toast:f}=V(),{data:t,isLoading:b}=_({queryKey:["/api/providers",m,"profile"],enabled:!!m&&n}),l=r=>Array.from({length:5},(x,a)=>e.jsx(ie,{className:`w-4 h-4 ${a<r?"text-yellow-400 fill-current":"text-gray-300"}`},a));return!n||!m?null:e.jsx(w,{open:n,onOpenChange:d,children:e.jsxs(C,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(U,{children:e.jsx(L,{asChild:!0,children:e.jsx(de,{children:"Profil du prestataire"})})}),e.jsx("div",{className:"p-6"}),b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):t?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"w-4 h-4 mr-1"}),t.location||"Localisation non spécifiée"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Membre depuis ",D(t.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:l(Math.round(parseFloat(t.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:t.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[t.totalProjects," projets réalisés"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.skills.map((r,x)=>e.jsx(N,{variant:"secondary",children:r},x))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(h,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${m}&name=${encodeURIComponent(o)}`},children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(h,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{f({title:"Contacter le prestataire",description:`Appelez ${o} pour discuter du projet`})},children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(h,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{f({title:"Réservation de créneau",description:`Fonctionnalité de réservation avec ${o} en cours de développement`})},children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Réserver un créneau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Réalisations récentes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:t.portfolio.slice(0,4).map(r=>e.jsx(F,{children:e.jsxs(M,{className:"p-4",children:[r.images.length>0&&e.jsx("img",{src:r.images[0],alt:r.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:r.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(N,{variant:"outline",children:r.category}),e.jsx("span",{className:"text-xs text-gray-500",children:D(r.completedAt)})]})]})},r.id))}),t.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune réalisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(re,{className:"w-5 h-5 mr-2"}),"Disponibilités"]}),e.jsx(F,{children:e.jsx(M,{className:"p-4",children:e.jsx(ue,{readOnly:!0,initialAvailability:t.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ae,{className:"w-5 h-5 mr-2"}),"Avis clients (",t.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:t.evaluations.map(r=>e.jsx(F,{children:e.jsxs(M,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[l(r.rating),e.jsx("span",{className:"ml-2 font-medium",children:r.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:D(r.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:r.comment}),r.photos&&r.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:r.photos.slice(0,3).map((x,a)=>e.jsx("img",{src:x,alt:`Photo ${a+1}`,className:"w-16 h-16 object-cover rounded-lg"},a))})]})},r.id))}),t.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{onClick:d,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvé"})})]})})}function Te({bidId:m,bidderName:o,isOpen:n,onClose:d}){const{user:f}=I(),{toast:t}=V(),b=J(),[l,r]=j.useState(null),[x,a]=j.useState(""),p=W({mutationFn:async c=>(await Y("POST","/api/bids/respond",c)).json(),onSuccess:()=>{b.invalidateQueries({queryKey:["/api/missions"]});const c=l==="accept"?"acceptée":l==="reject"?"déclinée":"en négociation";t({title:"Réponse envoyée !",description:`Votre réponse (${c}) a été envoyée au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre réponse "${c}" a bien été envoyée à ${o}. Un email de confirmation lui a été envoyé.`)},500),d(),r(null),a("")},onError:c=>{t({title:"Erreur",description:c.message||"Une erreur est survenue",variant:"destructive"})}}),y=c=>{if(c.preventDefault(),!l){t({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(l==="negotiate"&&!x.trim()){t({title:"Message requis",description:"Veuillez ajouter un message pour négocier",variant:"destructive"});return}p.mutate({bidId:m,status:l,message:x.trim()||null,clientResponse:l})},A=c=>{switch(c){case"accept":return`Bonjour ${o},

Nous avons le plaisir de vous informer que votre offre a été retenue pour ce projet. Nous allons procéder à la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${o},

Nous vous remercions pour votre offre. Malheureusement, nous avons décidé de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${o},

Votre offre nous intéresse. Cependant, nous aimerions discuter de certains points :

- 
- 

Êtes-vous ouvert à la négociation ?

Cordialement`}},v=c=>{r(c),a(A(c))};return e.jsx(w,{open:n,onOpenChange:d,children:e.jsxs(C,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsx(U,{children:e.jsxs(L,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(S,{className:"w-6 h-6 text-blue-500"}),"Répondre à l'offre de ",o]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre réponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>v("accept"),className:`p-4 rounded-xl border-2 transition-all ${l==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(je,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>v("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${l==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(S,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"Négocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>v("reject"),className:`p-4 rounded-xl border-2 transition-all ${l==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(fe,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"Décliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),l&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message à ",o]}),e.jsx(se,{id:"message",value:x,onChange:c=>a(c.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:d,className:"flex-1",disabled:p.isPending,children:"Annuler"}),e.jsx(h,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!l||p.isPending,children:p.isPending?"Envoi...":"Envoyer la réponse"})]})]})]})})}function We({missionId:m,isOpen:o,onClose:n}){const{user:d}=I(),[f,t]=j.useState("overview"),[b,l]=j.useState(null),[r,x]=j.useState(""),[a,p]=j.useState(null),[y,A]=j.useState(""),[v,c]=j.useState(!1),[P,O]=j.useState(!1),{data:i,isLoading:le,error:z}=_({queryKey:["mission-detail",m],queryFn:async()=>{if(!m)throw new Error("ID de mission manquant");console.log("🔍 Chargement mission ID:",m);try{const s=await fetch(`/api/missions/${m}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok){const T=await s.text();throw console.error("❌ Erreur API mission:",s.status,T),new Error(`Erreur ${s.status}: ${s.statusText}`)}const g=await s.json();return console.log("✅ Mission chargée:",g?.title||"Sans titre"),g}catch(s){throw console.error("❌ Erreur réseau mission:",s),s}},enabled:!!m&&o,retry:1,retryDelay:2e3,staleTime:3e4}),ne=s=>{const g=typeof s=="string"?parseFloat(s):s;return Array.from({length:5},(T,B)=>e.jsx(ie,{className:`w-3 h-3 ${B<Math.floor(g)?"text-yellow-400 fill-current":"text-gray-300"}`},B))};if(le)return e.jsx(w,{open:o,onOpenChange:n,children:e.jsx(C,{className:"w-[95vw] max-w-lg mx-auto p-0 gap-0 bg-white",children:e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Chargement..."})]})})})});if(z||!i)return e.jsx(w,{open:o,onOpenChange:n,children:e.jsx(C,{className:"w-[95vw] max-w-lg mx-auto p-6 gap-4 bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-50 rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erreur de chargement"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:z instanceof Error?z.message:"Mission introuvable"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(h,{onClick:()=>window.location.reload(),variant:"outline",size:"sm",children:"Recharger"}),e.jsx(h,{onClick:n,size:"sm",children:"Fermer"})]})]})})});const K=xe(i.category),u=i.bids?[...i.bids].sort((s,g)=>parseFloat(s.price)-parseFloat(g.price)):[],Q=i.teamRequirements&&i.teamRequirements.length>0;return e.jsxs(w,{open:o,onOpenChange:n,children:[e.jsxs(C,{className:"w-[95vw] h-[90vh] max-w-4xl p-0 gap-0 bg-gray-50 rounded-xl overflow-hidden",children:[e.jsxs(U,{className:"sr-only",children:[e.jsx(L,{children:i.title}),e.jsx(ce,{children:"Détails de la mission"})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-purple-600 text-white relative flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 md:p-6",children:[e.jsx(h,{onClick:n,size:"sm",variant:"ghost",className:"text-white hover:bg-white/20 p-2 rounded-full md:hidden",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 md:flex-none min-w-0",children:[e.jsx("h2",{className:"text-base md:text-xl font-bold leading-tight pr-2 md:pr-0 truncate",children:i.title}),e.jsxs("p",{className:"text-blue-100 text-xs md:text-sm mt-1 opacity-90 truncate",children:["Par ",i.clientName," • ",k(i.budget||"0")]})]}),e.jsx(h,{onClick:n,size:"sm",variant:"ghost",className:"text-white hover:bg-white/20 p-1.5 rounded-full","aria-label":"Fermer la modal",children:e.jsx(oe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"px-3 pb-3 md:px-6 md:pb-4",children:e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 text-xs text-blue-100 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3"}),e.jsxs("span",{children:[u.length," candidature",u.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:D(i.createdAt||new Date().toISOString())}),e.jsx("span",{className:"sm:hidden",children:"Créé"})]}),K&&e.jsx(N,{className:"bg-white/20 text-white border-none text-xs px-1.5 py-0.5",children:K.name})]})})]}),e.jsx("div",{className:"bg-white border-b flex-shrink-0",children:e.jsxs(he,{value:f,onValueChange:t,className:"w-full",children:[e.jsx(pe,{className:"w-full h-10 md:h-12 bg-transparent rounded-none border-none p-0",children:e.jsxs("div",{className:"flex w-full",children:[e.jsxs(q,{value:"overview",className:"flex-1 h-10 md:h-12 text-xs font-medium data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-blue-600 data-[state=active]:text-blue-600 rounded-none px-2",children:[e.jsx(ee,{className:"w-3 h-3 md:w-4 md:h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Aperçu"}),e.jsx("span",{className:"sm:hidden",children:"Info"})]}),e.jsxs(q,{value:"bids",className:"flex-1 h-10 md:h-12 text-xs font-medium data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-blue-600 data-[state=active]:text-blue-600 rounded-none px-2",children:[e.jsx(H,{className:"w-3 h-3 md:w-4 md:h-4 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Offres (",u.length,")"]}),e.jsxs("span",{className:"sm:hidden",children:["(",u.length,")"]})]}),Q&&e.jsxs(q,{value:"team",className:"flex-1 h-10 md:h-12 text-xs font-medium data-[state=active]:bg-transparent data-[state=active]:border-b-2 data-[state=active]:border-blue-600 data-[state=active]:text-blue-600 rounded-none px-2",children:[e.jsx(X,{className:"w-3 h-3 md:w-4 md:h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Équipe"}),e.jsx("span",{className:"sm:hidden",children:"Team"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx(R,{value:"overview",className:"m-0 h-full",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"p-3 md:p-6 space-y-3 md:space-y-4 pb-6 md:pb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 shadow-sm border",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-sm md:text-base",children:"Description du projet"}),e.jsx("p",{className:"text-gray-700 leading-relaxed text-sm md:text-base",children:i.description})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 md:p-4 border border-green-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 md:mb-2",children:[e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx(we,{className:"w-3 h-3 md:w-4 md:h-4 text-white"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs md:text-sm",children:"Budget"})]}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-green-600",children:k(i.budget||"0")})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 md:p-4 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 md:mb-2",children:[e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(te,{className:"w-3 h-3 md:w-4 md:h-4 text-white"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs md:text-sm",children:"Lieu"})]}),e.jsx("div",{className:"text-blue-600 font-medium text-xs md:text-base truncate",children:i.location||"Non spécifié"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 md:p-4 border border-purple-100 col-span-2 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 md:mb-2",children:[e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:e.jsx(Ce,{className:"w-3 h-3 md:w-4 md:h-4 text-white"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs md:text-sm",children:"Intérêt"})]}),e.jsxs("div",{className:"text-purple-600 font-medium text-xs md:text-base",children:[u.length," candidature",u.length!==1?"s":""]})]})]}),d&&d.type==="provider"&&i.clientName!==d.name&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 md:p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Candidater à cette mission"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Soumettez votre proposition"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(h,{onClick:()=>O(!P),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",size:"default",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Analyser avec l'IA"]}),e.jsxs(h,{onClick:()=>c(!v),className:"w-full bg-green-600 hover:bg-green-700 text-sm",size:"default",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),v?"Masquer le formulaire":"Soumettre une offre"]})]}),P&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(be,{missionTitle:i.title,missionDescription:i.description,missionBudget:parseFloat(i.budget||"0"),missionCategory:i.category,currentBid:{},providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:u,onOptimizedBidGenerated:s=>{c(!0)}})}),v&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Se,{missionId:i.id,onSuccess:()=>{c(!1),O(!1)}})})]}),d&&d.type==="provider"&&i.clientName===d.name&&e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-4 h-4 text-white"})}),e.jsx("p",{className:"text-blue-700 font-medium text-sm",children:"Ceci est votre mission"})]})})]})})}),e.jsx(R,{value:"bids",className:"m-0 h-full",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx("div",{className:"p-3 md:p-6 space-y-3 md:space-y-4 pb-6 md:pb-8",children:u.length===0?e.jsxs("div",{className:"bg-white rounded-lg p-8 md:p-12 text-center shadow-sm border",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(H,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune candidature"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Les prestataires peuvent encore postuler"})]}):e.jsx("div",{className:"space-y-3",children:u.map((s,g)=>e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 shadow-sm border hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:s.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 cursor-pointer hover:text-blue-600 transition-colors text-sm md:text-base",onClick:()=>{l(s.providerId),x(s.providerName)},children:s.providerName}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex items-center",children:ne(s.rating||"5.0")}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:[parseFloat(s.rating||"5.0").toFixed(1),"/5"]}),g===0&&u.length>1&&e.jsx(N,{className:"bg-green-100 text-green-700 text-xs ml-2",children:"Meilleure offre"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg md:text-xl font-bold text-green-600",children:k(s.price)}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-end mt-1",children:[e.jsx(re,{className:"w-3 h-3 mr-1"}),s.timeline]})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4 mb-4 border-l-4 border-blue-400",children:e.jsx("p",{className:"text-gray-700 text-sm md:text-base leading-relaxed whitespace-pre-line",children:s.proposal})}),d&&i.userName===d.name&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs(h,{onClick:()=>{p(s.id),A(s.providerName)},variant:"outline",size:"sm",className:"flex items-center justify-center gap-2 text-sm",children:[e.jsx(S,{className:"w-4 h-4"}),"Répondre"]}),e.jsxs(h,{size:"sm",className:"bg-green-500 hover:bg-green-600 text-white flex items-center justify-center gap-2 text-sm",children:[e.jsx(Z,{className:"w-4 h-4"}),"Accepter"]})]})]},s.id))})})})}),Q&&e.jsx(R,{value:"team",className:"m-0 h-full",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx("div",{className:"p-3 md:p-6 space-y-3 md:space-y-4 pb-6 md:pb-8",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 shadow-sm border",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(X,{className:"w-5 h-5"}),"Composition de l'équipe"]}),e.jsx("div",{className:"space-y-3",children:i.teamRequirements?.map((s,g)=>e.jsxs("div",{className:"border-l-4 border-l-blue-500 bg-blue-50/50 rounded-r-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm md:text-base",children:s.role}),e.jsx("p",{className:"text-gray-600 text-xs md:text-sm",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm md:text-base font-bold text-green-600",children:k(s.budget||"0")}),e.jsxs(N,{variant:"outline",className:"text-xs",children:[s.quantity," personne",s.quantity>1?"s":""]})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-xs mb-2",children:"Compétences :"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.skills.map((T,B)=>e.jsx(N,{variant:"secondary",className:"text-xs",children:T},B))})]})]},g))})]})})})})]})]})})]})]}),e.jsx(Ae,{providerId:b,providerName:r,isOpen:!!b,onClose:()=>{l(null),x("")}}),e.jsx(Te,{bidId:a,bidderName:y,isOpen:!!a,onClose:()=>{p(null),A("")}})]})}export{We as M};
