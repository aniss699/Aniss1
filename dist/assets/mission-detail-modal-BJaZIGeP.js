import{r as u,j as e}from"./ui-BW6CElO3.js";import{u as se}from"./useQuery-ULOzoGd_.js";import{d as G,e as X,f as re,g as te,L as R,I as Y,B as p,h as ae,D as A,i as S,j as T,k as B,V as ue,l as $,C as g,b as j,m as U,U as O,T as Z,a as D,n as K}from"./index-CeyWb44D.js";import{a as P,g as ge,f as E}from"./categories-DUi1-GTl.js";import{T as ie}from"./textarea-vXJzAAjs.js";import{B as y}from"./badge-BFDiZWfr.js";import{T as je,a as fe,b as Q,c as H}from"./tabs-DutlLzfS.js";import{U as ee,L as ve}from"./lucide-react-DVQBDERc.js";import{A as Ne}from"./availability-calendar-B8taRwsW.js";import{M as le}from"./map-pin-BAVoS8RV.js";import{C as _}from"./calendar-CxZDpOXK.js";import{M as I}from"./message-circle-CDQuc1i6.js";import{P as be}from"./phone-DQspOcbd.js";import{C as ne}from"./clock-Drlz0_G5.js";import{A as ce}from"./award-DQzPnlv9.js";import{S as oe}from"./star-CXmTH7D6.js";import{C as ye}from"./circle-check-big-T-pNY54F.js";import{C as we}from"./circle-x-B5BXyjX_.js";import{S as Ce}from"./smart-bid-analyzer-UFYG_xDC.js";import{E as Ae}from"./euro-JGTNYqRo.js";function Se({missionId:m,onSuccess:d}){const{user:o}=G(),{toast:l}=X(),v=re(),[r,N]=u.useState({price:"",timeline:"",proposal:""}),n=te({mutationFn:async i=>(await ae("POST","/api/bids",i)).json(),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/missions",m]}),v.invalidateQueries({queryKey:["/api/missions"]}),v.invalidateQueries({queryKey:["/api/users",o?.id,"bids"]}),l({title:"Offre envoyée !",description:"Votre offre a été envoyée avec succès"}),N({price:"",timeline:"",proposal:""}),d()},onError:i=>{l({title:"Erreur",description:i.message||"Une erreur est survenue",variant:"destructive"})}}),a=i=>{if(i.preventDefault(),!r.price||!r.timeline||!r.proposal){l({title:"Champs requis",description:"Veuillez remplir tous les champs",variant:"destructive"});return}if(!o){l({title:"Connexion requise",description:"Vous devez être connecté pour postuler",variant:"destructive"});return}n.mutate({missionId:m,providerId:o.id,providerName:o.name,price:parseFloat(r.price),timeline:r.timeline,proposal:r.proposal,rating:o.rating||"5.0"})},x=(i,f)=>{N(w=>({...w,[i]:f}))};return!o||o.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"price",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"💰"}),e.jsx("span",{children:"Prix proposé (€)"})]}),e.jsx(Y,{id:"price",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:r.price,onChange:i=>x("price",i.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsx("span",{children:"Délai de livraison"})]}),e.jsx(Y,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:r.timeline,onChange:i=>x("timeline",i.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📝"}),e.jsx("span",{children:"Décrivez votre proposition"})]}),e.jsx(ie,{id:"proposal",placeholder:"Expliquez votre approche, votre expérience pertinente et ce que vous allez concrètement livrer pour cette mission...",value:r.proposal,onChange:i=>x("proposal",i.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx(p,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:n.isPending,children:n.isPending?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🚀"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function Te({providerId:m,providerName:d,isOpen:o,onClose:l}){const{toast:v}=X(),{data:r,isLoading:N}=se({queryKey:["/api/providers",m,"profile"],enabled:!!m&&o}),n=a=>Array.from({length:5},(x,i)=>e.jsx(oe,{className:`w-4 h-4 ${i<a?"text-yellow-400 fill-current":"text-gray-300"}`},i));return!o||!m?null:e.jsx(A,{open:o,onOpenChange:l,children:e.jsxs(S,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(T,{children:e.jsx(B,{asChild:!0,children:e.jsx(ue,{children:"Profil du prestataire"})})}),e.jsx("div",{className:"p-6"}),N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):r?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-4 h-4 mr-1"}),r.location||"Localisation non spécifiée"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"Membre depuis ",P(r.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:r.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:n(Math.round(parseFloat(r.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:r.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.totalProjects," projets réalisés"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.skills.map((a,x)=>e.jsx(y,{variant:"secondary",children:a},x))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(p,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${m}&name=${encodeURIComponent(d)}`},children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(p,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{v({title:"Contacter le prestataire",description:`Appelez ${d} pour discuter du projet`})},children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(p,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{v({title:"Réservation de créneau",description:`Fonctionnalité de réservation avec ${d} en cours de développement`})},children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Réserver un créneau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Réalisations récentes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:r.portfolio.slice(0,4).map(a=>e.jsx(g,{children:e.jsxs(j,{className:"p-4",children:[a.images.length>0&&e.jsx("img",{src:a.images[0],alt:a.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:a.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(y,{variant:"outline",children:a.category}),e.jsx("span",{className:"text-xs text-gray-500",children:P(a.completedAt)})]})]})},a.id))}),r.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune réalisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ne,{className:"w-5 h-5 mr-2"}),"Disponibilités"]}),e.jsx(g,{children:e.jsx(j,{className:"p-4",children:e.jsx(Ne,{readOnly:!0,initialAvailability:r.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 mr-2"}),"Avis clients (",r.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.evaluations.map(a=>e.jsx(g,{children:e.jsxs(j,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[n(a.rating),e.jsx("span",{className:"ml-2 font-medium",children:a.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:P(a.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:a.comment}),a.photos&&a.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:a.photos.slice(0,3).map((x,i)=>e.jsx("img",{src:x,alt:`Photo ${i+1}`,className:"w-16 h-16 object-cover rounded-lg"},i))})]})},a.id))}),r.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{onClick:l,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvé"})})]})})}function Be({bidId:m,bidderName:d,isOpen:o,onClose:l}){const{user:v}=G(),{toast:r}=X(),N=re(),[n,a]=u.useState(null),[x,i]=u.useState(""),f=te({mutationFn:async c=>(await ae("POST","/api/bids/respond",c)).json(),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/missions"]});const c=n==="accept"?"acceptée":n==="reject"?"déclinée":"en négociation";r({title:"Réponse envoyée !",description:`Votre réponse (${c}) a été envoyée au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre réponse "${c}" a bien été envoyée à ${d}. Un email de confirmation lui a été envoyé.`)},500),l(),a(null),i("")},onError:c=>{r({title:"Erreur",description:c.message||"Une erreur est survenue",variant:"destructive"})}}),w=c=>{if(c.preventDefault(),!n){r({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(n==="negotiate"&&!x.trim()){r({title:"Message requis",description:"Veuillez ajouter un message pour négocier",variant:"destructive"});return}f.mutate({bidId:m,status:n,message:x.trim()||null,clientResponse:n})},q=c=>{switch(c){case"accept":return`Bonjour ${d},

Nous avons le plaisir de vous informer que votre offre a été retenue pour ce projet. Nous allons procéder à la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${d},

Nous vous remercions pour votre offre. Malheureusement, nous avons décidé de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${d},

Votre offre nous intéresse. Cependant, nous aimerions discuter de certains points :

- 
- 

Êtes-vous ouvert à la négociation ?

Cordialement`}},b=c=>{a(c),i(q(c))};return e.jsx(A,{open:o,onOpenChange:l,children:e.jsxs(S,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsx(T,{children:e.jsxs(B,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(I,{className:"w-6 h-6 text-blue-500"}),"Répondre à l'offre de ",d]})}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre réponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>b("accept"),className:`p-4 rounded-xl border-2 transition-all ${n==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(ye,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>b("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${n==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(I,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"Négocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>b("reject"),className:`p-4 rounded-xl border-2 transition-all ${n==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(we,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"Décliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message à ",d]}),e.jsx(ie,{id:"message",value:x,onChange:c=>i(c.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:l,className:"flex-1",disabled:f.isPending,children:"Annuler"}),e.jsx(p,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!n||f.isPending,children:f.isPending?"Envoi...":"Envoyer la réponse"})]})]})]})})}function Xe({missionId:m,isOpen:d,onClose:o}){const{user:l}=G(),[v,r]=u.useState("overview"),[N,n]=u.useState(null),[a,x]=u.useState(""),[i,f]=u.useState(null),[w,q]=u.useState(""),[b,c]=u.useState(!1),[z,J]=u.useState(!1),[V,de]=u.useState({}),{data:t,isLoading:me,error:L}=se({queryKey:["mission",m],queryFn:async()=>{if(!m)throw new Error("Mission ID is required");console.log("🔍 Chargement mission ID:",m);const s=await fetch(`/api/missions/${m}`);if(!s.ok)throw console.error("❌ Erreur API mission:",s.status,s.statusText),new Error(`Erreur ${s.status}: ${s.statusText}`);const h=await s.json();return console.log("✅ Mission chargée:",h.title),h},enabled:!!m&&d,retry:2,retryDelay:s=>Math.min(1e3*2**s,1e4)}),xe=s=>ve[s.split("-").map(C=>C.charAt(0).toUpperCase()+C.slice(1)).join("")]||$,pe=s=>{const h=parseFloat(s);return Array.from({length:5},(C,F)=>e.jsx(oe,{className:`w-4 h-4 ${F<Math.floor(h)?"text-yellow-400 fill-current":"text-gray-300"}`},F))};if(me)return e.jsx(A,{open:d,onOpenChange:o,children:e.jsxs(S,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(T,{children:[e.jsx(B,{children:"Chargement..."}),e.jsx(U,{children:"Chargement des détails de la mission..."})]}),e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]})});if(L||!t)return e.jsx(A,{open:d,onOpenChange:o,children:e.jsxs(S,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(T,{children:[e.jsx(B,{children:"Erreur"}),e.jsx(U,{children:"Impossible de charger les détails de la mission"})]}),e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"text-red-500 mb-4 text-4xl",children:"❌"}),e.jsx("p",{className:"text-gray-500 mb-4",children:L instanceof Error?L.message:"Mission non trouvée"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(p,{onClick:()=>window.location.reload(),variant:"outline",children:"Recharger"}),e.jsx(p,{onClick:o,variant:"outline",children:"Fermer"})]})]})]})});const M=ge(t.category),he=M?xe(M.icon):$,k=[...t.bids].sort((s,h)=>parseFloat(s.price)-parseFloat(h.price)),W=t.teamRequirements&&t.teamRequirements.length>0;return e.jsxs(A,{open:d,onOpenChange:o,children:[e.jsxs(S,{className:"w-[96vw] max-w-6xl max-h-[92vh] overflow-y-auto p-0",children:[e.jsxs(T,{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white",children:[e.jsx(B,{className:"text-2xl font-bold pr-6",children:t.title}),e.jsxs(U,{className:"text-blue-100 mt-2",children:["Par ",t.clientName," • ",E(t.budget||"0")," • ",t.bids.length," candidature",t.bids.length!==1?"s":""]})]}),e.jsx("div",{className:"p-6",children:e.jsxs(je,{value:v,onValueChange:r,className:"w-full",children:[e.jsxs(fe,{className:"grid w-full grid-cols-3",children:[e.jsxs(Q,{value:"overview",className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Aperçu"]}),e.jsxs(Q,{value:"bids",className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Candidatures (",t.bids.length,")"]}),W&&e.jsxs(Q,{value:"team",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Équipe"]})]}),e.jsxs(H,{value:"overview",className:"space-y-6 mt-6",children:[e.jsxs(g,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center",children:e.jsx(he,{className:`w-8 h-8 ${M?.color||"text-blue-600"}`})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:t.title}),e.jsxs("p",{className:"text-gray-500",children:["Par ",e.jsx("span",{className:"font-medium text-blue-600",children:t.clientName})," • ",P(t.createdAt)]})]}),e.jsx(y,{className:"bg-green-100 text-green-700",children:M?.name||t.category})]})})]})}),e.jsxs(j,{children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.description})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Budget"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:E(t.budget||"0")})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(le,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Localisation"})]}),e.jsx("div",{className:"text-blue-600 font-medium",children:t.location||"Non spécifié"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Publié"})]}),e.jsx("div",{className:"text-purple-600 font-medium",children:P(t.createdAt)})]})]})]})]}),l&&l.type==="provider"&&t.clientName!==l.name&&e.jsxs(g,{className:"border-2 border-green-200 bg-gradient-to-br from-green-50 to-emerald-50",children:[e.jsx(D,{children:e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(ce,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold",children:"Postuler à cette mission"}),e.jsx("p",{className:"text-sm text-gray-600 font-normal",children:"Soumettez votre offre avec prix et délai"})]})]})}),e.jsxs(j,{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(p,{onClick:()=>J(!z),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",size:"lg",children:"🧠 Analyser avec l'IA"}),e.jsx(p,{onClick:()=>c(!b),className:"w-full bg-primary hover:bg-primary/90",size:"lg",children:b?"Masquer le formulaire":"Soumettre une offre"})]}),z&&e.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border",children:e.jsx(Ce,{missionTitle:t.title,missionDescription:t.description,missionBudget:parseFloat(t.budget||"0"),missionCategory:t.category,currentBid:V,providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:t.bids,onOptimizedBidGenerated:s=>{de(s),c(!0)}})}),b&&e.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border",children:e.jsx(Se,{missionId:t.id,onSuccess:()=>{c(!1),J(!1)},initialValues:V.proposal?V:void 0})})]})]}),l&&l.type==="provider"&&t.clientName===l.name&&e.jsx(g,{className:"border-2 border-blue-200 bg-blue-50",children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(ee,{className:"w-5 h-5 text-white"})}),e.jsx("p",{className:"text-blue-700 font-medium",children:"Ceci est votre propre mission"})]})})})]}),e.jsxs(H,{value:"bids",className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Offres reçues (",t.bids.length,")"]}),k.length>0&&e.jsx(y,{variant:"outline",children:"Triées par prix croissant"})]}),k.length===0?e.jsx(g,{children:e.jsxs(j,{className:"text-center py-12",children:[e.jsx(O,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune offre reçue"}),e.jsx("p",{className:"text-gray-500",children:"Les prestataires peuvent encore postuler à cette mission"})]})}):e.jsx("div",{className:"space-y-4",children:k.map((s,h)=>e.jsx(g,{className:"hover:shadow-md transition-shadow",children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:s.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-lg cursor-pointer hover:text-primary transition-colors",onClick:()=>{n(s.providerId),x(s.providerName)},children:s.providerName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[pe(s.rating||"5.0"),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:[parseFloat(s.rating||"5.0").toFixed(1),"/5"]})]}),h===0&&k.length>1&&e.jsx(y,{className:"bg-green-100 text-green-700",children:"Meilleure offre"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:E(s.price)}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center justify-end mt-1",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),s.timeline]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg p-4 mb-4 border-l-4 border-blue-400",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-line leading-relaxed",children:s.proposal})}),l&&t.clientName===l.name&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(p,{onClick:()=>{f(s.id),q(s.providerName)},variant:"outline",className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Répondre"]}),e.jsxs(p,{className:"bg-green-500 hover:bg-green-600 text-white flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"Accepter l'offre"]})]})]})},s.id))})]}),W&&e.jsxs(H,{value:"team",className:"space-y-6 mt-6",children:[e.jsxs(g,{children:[e.jsx(D,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Composition de l'équipe requise"]})}),e.jsx(j,{children:e.jsx("div",{className:"grid gap-4",children:t.teamRequirements?.map((s,h)=>e.jsx(g,{className:"border-l-4 border-l-blue-500",children:e.jsxs(j,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.role}),e.jsx("p",{className:"text-gray-600",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:E(s.budget||"0")}),e.jsxs(y,{variant:"outline",children:[s.quantity," personne",s.quantity>1?"s":""]})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Compétences requises :"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.skills.map((C,F)=>e.jsx(y,{variant:"secondary",className:"text-xs",children:C},F))})]})]})},h))})})]}),l&&l.type==="provider"&&t.clientName!==l.name&&e.jsxs(g,{className:"border-2 border-orange-200 bg-gradient-to-br from-orange-50 to-yellow-50",children:[e.jsx(D,{children:e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-500 to-yellow-600 rounded-xl flex items-center justify-center",children:e.jsx(O,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold",children:"Candidature d'équipe"}),e.jsx("p",{className:"text-sm text-gray-600 font-normal",children:"Postulez pour un ou plusieurs rôles"})]})]})}),e.jsx(j,{children:e.jsx("p",{className:"text-center text-gray-600 py-4",children:"Fonctionnalité de candidature d'équipe en cours de développement"})})]})]})]})})]}),e.jsx(Te,{providerId:N,providerName:a,isOpen:!!N,onClose:()=>{n(null),x("")}}),e.jsx(Be,{bidId:i,bidderName:w,isOpen:!!i,onClose:()=>{f(null),q("")}})]})}export{Xe as M};
