import{r as l,j as e}from"./ui-BW6CElO3.js";import{S as b,a as y,b as w,c as k,d as S}from"./select-BgyW-1T2.js";import{C as h,b as u,B as C,X as E,f as D,a as M,h as P}from"./index-CruXR4SJ.js";import{B as N}from"./badge-B6EIsa0n.js";import{S as I}from"./star-C4SHTlAV.js";import{C as L}from"./clock-DhwM5UP0.js";import{M as F}from"./map-pin-CFL41LCE.js";import{E as z}from"./euro-CIOn5Ay8.js";import{T as A}from"./thumbs-up-TJd7oQwP.js";import{s as R}from"./services-CKGK_1bf.js";import{F as $}from"./filter-D2IzgaXv.js";import{R as B}from"./refresh-cw-DzPMvm9v.js";import"./vendor-D3F3s8fL.js";import"./index-DDShL7U6.js";function K({slots:a,onSwipeRight:p,onSwipeLeft:c,isLoading:f=!1}){const[i,j]=l.useState(0),[n,d]=l.useState(!1),t=a[i],o=l.useCallback(()=>{!t||n||(d(!0),p(t),setTimeout(()=>{j(r=>Math.min(r+1,a.length-1)),d(!1)},300))},[t,p,n,a.length]),m=l.useCallback(()=>{!t||n||(d(!0),c(t),setTimeout(()=>{j(r=>Math.min(r+1,a.length-1)),d(!1)},300))},[t,c,n,a.length]),x=l.useCallback(r=>{r.key==="ArrowLeft"?m():r.key==="ArrowRight"&&o()},[m,o]);l.useEffect(()=>(window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)),[x]);const g=r=>new Date(r).toLocaleDateString("fr-FR",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});return f?e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600"})}):t?e.jsx("div",{className:"max-w-sm mx-auto",children:e.jsx(h,{className:`relative overflow-hidden transition-all duration-300 ${n?"scale-95 opacity-70":"scale-100 opacity-100"}`,children:e.jsxs(u,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-lg",children:t.providerName.charAt(0)})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.providerName}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(I,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:t.rating.toFixed(1)})]})]})]}),e.jsx(N,{variant:"outline",className:"text-green-600 border-green-600",children:"Disponible"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:g(t.slot)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:["À ",t.distance," km"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm font-medium",children:[t.pricePerHour,"€/h • ",t.duration," min"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-6",children:t.tags.map((r,s)=>e.jsx(N,{variant:"secondary",className:"text-xs",children:r},s))}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(C,{onClick:m,variant:"outline",size:"lg",className:"flex-1 border-red-200 text-red-600 hover:bg-red-50",disabled:n,children:[e.jsx(E,{className:"w-5 h-5 mr-2"}),"Passer"]}),e.jsxs(C,{onClick:o,size:"lg",className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",disabled:n,children:[e.jsx(A,{className:"w-5 h-5 mr-2"}),"Réserver"]})]}),e.jsx("div",{className:"mt-4 flex justify-center space-x-1",children:a.slice(0,5).map((r,s)=>e.jsx("div",{className:`w-2 h-2 rounded-full ${s===i?"bg-purple-600":"bg-gray-300"}`},s))}),e.jsx("p",{className:"text-xs text-center text-gray-400 mt-3",children:"← Passer • Réserver → • ↑ Suivant"})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Plus d'opportunités pour le moment"}),e.jsx("p",{className:"text-gray-600",children:"Revenez plus tard ou modifiez vos filtres"})]})}const O=["Tous","Développement","Design","Marketing","Conseil","Formation"],V=[{value:"",label:"Toutes distances"},{value:"5",label:"5 km"},{value:"10",label:"10 km"},{value:"20",label:"20 km"},{value:"50",label:"50 km"}];function ae(){const[a,p]=l.useState([]),[c,f]=l.useState(!0),[i,j]=l.useState({}),[n,d]=l.useState(Date.now()),{toast:t}=D(),o=async()=>{f(!0);try{const s=await R.getLiveSlots(i);p(s),d(Date.now())}catch{t({title:"Erreur",description:"Impossible de charger les opportunités.",variant:"destructive"})}finally{f(!1)}};l.useEffect(()=>{o()},[i]),l.useEffect(()=>{const s=setInterval(()=>{c||o()},3e4);return()=>clearInterval(s)},[c]);const m=async s=>{try{(await R.reserveSlot(s.id)).success&&t({title:"Créneaux réservé !",description:`Vous avez réservé le créneau avec ${s.providerName}`})}catch{t({title:"Erreur",description:"Impossible de réserver ce créneau.",variant:"destructive"})}},x=s=>{},g=(s,v)=>{j(T=>({...T,[s]:v||void 0}))},r=()=>{const s=Math.floor((Date.now()-n)/1e3);return s<60?`il y a ${s}s`:`il y a ${Math.floor(s/60)}min`};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-block p-4 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full mb-4",children:e.jsx(L,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Opportunités Locales"}),e.jsx("p",{className:"text-gray-600",children:"Créneaux libres près de chez vous • Réservation instantanée"})]}),e.jsxs(h,{className:"mb-8",children:[e.jsx(M,{children:e.jsxs(P,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"w-5 h-5 text-indigo-600"}),e.jsx("span",{children:"Filtres"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsxs("span",{children:["Mis à jour ",r()]})]})]})}),e.jsxs(u,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Catégorie"}),e.jsxs(b,{onValueChange:s=>g("category",s==="Tous"?"":s),children:[e.jsx(y,{children:e.jsx(w,{placeholder:"Toutes catégories"})}),e.jsx(k,{children:O.map(s=>e.jsx(S,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Rayon"}),e.jsxs(b,{onValueChange:s=>g("radiusKm",s?Number(s):""),children:[e.jsx(y,{children:e.jsx(w,{placeholder:"Toutes distances"})}),e.jsx(k,{children:V.map(s=>e.jsx(S,{value:s.value,children:s.label},s.value))})]})]})]}),Object.keys(i).length>0&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[i.category&&e.jsx(N,{variant:"outline",className:"text-indigo-600",children:i.category}),i.radiusKm&&e.jsxs(N,{variant:"outline",className:"text-indigo-600",children:[i.radiusKm," km"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsx(h,{children:e.jsxs(u,{className:"text-center py-4",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:a.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Créneaux"})]})}),e.jsx(h,{children:e.jsxs(u,{className:"text-center py-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[a.length?Math.min(...a.map(s=>s.pricePerHour)):0,"€"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Prix min/h"})]})}),e.jsx(h,{children:e.jsxs(u,{className:"text-center py-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[a.length?Math.min(...a.map(s=>s.distance)):0,"km"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Plus proche"})]})})]}),e.jsx(K,{slots:a,onSwipeRight:m,onSwipeLeft:x,isLoading:c})]})})}export{ae as default};
