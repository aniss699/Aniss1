import{r as f,j as e}from"./ui-BW6CElO3.js";import{u as Z}from"./useQuery-C8q2V5pE.js";import{d as G,f as _,e as ee,g as se,i as re,L as M,I as J,B as h,D as S,j as A,k as T,l as B,V as de,m as K,C as p,b as u,n as me,U as V,T as W,a as E,h as O}from"./index-ptEpwDEZ.js";import{a as P,g as xe,f as F}from"./categories-Ci5EyH-Y.js";import{T as te}from"./textarea-CUall8q9.js";import{B as w}from"./badge-BlnUqV1y.js";import{T as he,a as pe,b as U,c as L}from"./tabs-Cy4r9iaI.js";import{A as ue}from"./availability-calendar-C9cwbwoR.js";import{M as ae}from"./map-pin-D5A9doTX.js";import{C as Q}from"./calendar-5yWWwMNB.js";import{M as R}from"./message-circle-BpQIobf3.js";import{P as ge}from"./phone-CasYOOt7.js";import{C as H}from"./clock-RtbJLNkQ.js";import{A as ie}from"./award-DnuiYKz8.js";import{S as le}from"./star-DCB7wOJ-.js";import{C as je}from"./circle-check-big-L29MxYvt.js";import{C as fe}from"./circle-x-s6i3L_Iw.js";import{S as Ne}from"./smart-bid-analyzer-BJdt1agI.js";import{C as ve}from"./circle-alert-D_073VYu.js";import{E as be}from"./euro-CIe3Bq7B.js";import{U as Y}from"./user-check-Bk1TDvo_.js";function ye({missionId:m,onSuccess:d}){const{user:o}=G(),{toast:l}=_(),N=ee(),[r,v]=f.useState({price:"",timeline:"",proposal:""}),n=se({mutationFn:async i=>(await re("POST","/api/bids",i)).json(),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/missions",m]}),N.invalidateQueries({queryKey:["/api/missions"]}),N.invalidateQueries({queryKey:["/api/users",o?.id,"bids"]}),l({title:"Offre envoyée !",description:"Votre offre a été envoyée avec succès"}),v({price:"",timeline:"",proposal:""}),d()},onError:i=>{l({title:"Erreur",description:i.message||"Une erreur est survenue",variant:"destructive"})}}),t=i=>{if(i.preventDefault(),!r.price||!r.timeline||!r.proposal){l({title:"Champs requis",description:"Veuillez remplir tous les champs",variant:"destructive"});return}if(!o){l({title:"Connexion requise",description:"Vous devez être connecté pour postuler",variant:"destructive"});return}n.mutate({missionId:m,providerId:o.id,providerName:o.name,price:parseFloat(r.price),timeline:r.timeline,proposal:r.proposal,rating:o.rating||"5.0"})},x=(i,g)=>{v(C=>({...C,[i]:g}))};return!o||o.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"price",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"💰"}),e.jsx("span",{children:"Prix proposé (€)"})]}),e.jsx(J,{id:"price",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:r.price,onChange:i=>x("price",i.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsx("span",{children:"Délai de livraison"})]}),e.jsx(J,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:r.timeline,onChange:i=>x("timeline",i.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📝"}),e.jsx("span",{children:"Décrivez votre proposition"})]}),e.jsx(te,{id:"proposal",placeholder:"Expliquez votre approche, votre expérience pertinente et ce que vous allez concrètement livrer pour cette mission...",value:r.proposal,onChange:i=>x("proposal",i.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx(h,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:n.isPending,children:n.isPending?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🚀"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function we({providerId:m,providerName:d,isOpen:o,onClose:l}){const{toast:N}=_(),{data:r,isLoading:v}=Z({queryKey:["/api/providers",m,"profile"],enabled:!!m&&o}),n=t=>Array.from({length:5},(x,i)=>e.jsx(le,{className:`w-4 h-4 ${i<t?"text-yellow-400 fill-current":"text-gray-300"}`},i));return!o||!m?null:e.jsx(S,{open:o,onOpenChange:l,children:e.jsxs(A,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(T,{children:e.jsx(B,{asChild:!0,children:e.jsx(de,{children:"Profil du prestataire"})})}),e.jsx("div",{className:"p-6"}),v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):r?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),r.location||"Localisation non spécifiée"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Membre depuis ",P(r.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:r.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:n(Math.round(parseFloat(r.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:r.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.totalProjects," projets réalisés"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.skills.map((t,x)=>e.jsx(w,{variant:"secondary",children:t},x))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(h,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${m}&name=${encodeURIComponent(d)}`},children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(h,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{N({title:"Contacter le prestataire",description:`Appelez ${d} pour discuter du projet`})},children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(h,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{N({title:"Réservation de créneau",description:`Fonctionnalité de réservation avec ${d} en cours de développement`})},children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Réserver un créneau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(K,{className:"w-5 h-5 mr-2"}),"Réalisations récentes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:r.portfolio.slice(0,4).map(t=>e.jsx(p,{children:e.jsxs(u,{className:"p-4",children:[t.images.length>0&&e.jsx("img",{src:t.images[0],alt:t.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(w,{variant:"outline",children:t.category}),e.jsx("span",{className:"text-xs text-gray-500",children:P(t.completedAt)})]})]})},t.id))}),r.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune réalisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Disponibilités"]}),e.jsx(p,{children:e.jsx(u,{className:"p-4",children:e.jsx(ue,{readOnly:!0,initialAvailability:r.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ie,{className:"w-5 h-5 mr-2"}),"Avis clients (",r.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.evaluations.map(t=>e.jsx(p,{children:e.jsxs(u,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[n(t.rating),e.jsx("span",{className:"ml-2 font-medium",children:t.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:P(t.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:t.comment}),t.photos&&t.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:t.photos.slice(0,3).map((x,i)=>e.jsx("img",{src:x,alt:`Photo ${i+1}`,className:"w-16 h-16 object-cover rounded-lg"},i))})]})},t.id))}),r.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{onClick:l,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvé"})})]})})}function Ce({bidId:m,bidderName:d,isOpen:o,onClose:l}){const{user:N}=G(),{toast:r}=_(),v=ee(),[n,t]=f.useState(null),[x,i]=f.useState(""),g=se({mutationFn:async c=>(await re("POST","/api/bids/respond",c)).json(),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/missions"]});const c=n==="accept"?"acceptée":n==="reject"?"déclinée":"en négociation";r({title:"Réponse envoyée !",description:`Votre réponse (${c}) a été envoyée au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre réponse "${c}" a bien été envoyée à ${d}. Un email de confirmation lui a été envoyé.`)},500),l(),t(null),i("")},onError:c=>{r({title:"Erreur",description:c.message||"Une erreur est survenue",variant:"destructive"})}}),C=c=>{if(c.preventDefault(),!n){r({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(n==="negotiate"&&!x.trim()){r({title:"Message requis",description:"Veuillez ajouter un message pour négocier",variant:"destructive"});return}g.mutate({bidId:m,status:n,message:x.trim()||null,clientResponse:n})},q=c=>{switch(c){case"accept":return`Bonjour ${d},

Nous avons le plaisir de vous informer que votre offre a été retenue pour ce projet. Nous allons procéder à la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${d},

Nous vous remercions pour votre offre. Malheureusement, nous avons décidé de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${d},

Votre offre nous intéresse. Cependant, nous aimerions discuter de certains points :

- 
- 

Êtes-vous ouvert à la négociation ?

Cordialement`}},y=c=>{t(c),i(q(c))};return e.jsx(S,{open:o,onOpenChange:l,children:e.jsxs(A,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsx(T,{children:e.jsxs(B,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(R,{className:"w-6 h-6 text-blue-500"}),"Répondre à l'offre de ",d]})}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre réponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>y("accept"),className:`p-4 rounded-xl border-2 transition-all ${n==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(je,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>y("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${n==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(R,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"Négocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>y("reject"),className:`p-4 rounded-xl border-2 transition-all ${n==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(fe,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"Décliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message à ",d]}),e.jsx(te,{id:"message",value:x,onChange:c=>i(c.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:l,className:"flex-1",disabled:g.isPending,children:"Annuler"}),e.jsx(h,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!n||g.isPending,children:g.isPending?"Envoi...":"Envoyer la réponse"})]})]})]})})}function He({missionId:m,isOpen:d,onClose:o}){const{user:l}=G(),[N,r]=f.useState("overview"),[v,n]=f.useState(null),[t,x]=f.useState(""),[i,g]=f.useState(null),[C,q]=f.useState(""),[y,c]=f.useState(!1),[$,X]=f.useState(!1),{data:a,isLoading:ne,error:z}=Z({queryKey:["mission-detail",m],queryFn:async()=>{if(!m)throw new Error("ID de mission manquant");console.log("🔍 Chargement mission ID:",m);try{const s=await fetch(`/api/missions/${m}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok){const k=await s.text();throw console.error("❌ Erreur API mission:",s.status,k),new Error(`Erreur ${s.status}: ${s.statusText}`)}const j=await s.json();return console.log("✅ Mission chargée:",j?.title||"Sans titre"),j}catch(s){throw console.error("❌ Erreur réseau mission:",s),s}},enabled:!!m&&d,retry:1,retryDelay:2e3,staleTime:3e4}),ce=s=>{const j=typeof s=="string"?parseFloat(s):s;return Array.from({length:5},(k,D)=>e.jsx(le,{className:`w-4 h-4 ${D<Math.floor(j)?"text-yellow-400 fill-current":"text-gray-300"}`},D))};if(ne)return e.jsx(S,{open:d,onOpenChange:o,children:e.jsxs(A,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(T,{children:e.jsx(B,{children:"Chargement de la mission..."})}),e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("p",{className:"text-gray-600",children:"Chargement des détails..."})]})})]})});if(z||!a)return e.jsx(S,{open:d,onOpenChange:o,children:e.jsxs(A,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(T,{children:e.jsxs(B,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(ve,{className:"w-5 h-5"}),"Erreur de chargement"]})}),e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"text-red-500 mb-4 text-6xl",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Impossible de charger la mission"}),e.jsx("p",{className:"text-gray-500 mb-6",children:z instanceof Error?z.message:"Mission introuvable ou serveur indisponible"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(h,{onClick:()=>window.location.reload(),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Recharger"]}),e.jsx(h,{onClick:o,children:"Fermer"})]})]})]})});const oe=xe(a.category),b=a.bids?[...a.bids].sort((s,j)=>parseFloat(s.price)-parseFloat(j.price)):[],I=a.teamRequirements&&a.teamRequirements.length>0;return e.jsxs(S,{open:d,onOpenChange:o,children:[e.jsxs(A,{className:"w-[96vw] max-w-6xl max-h-[92vh] overflow-y-auto p-0",children:[e.jsxs(T,{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white",children:[e.jsx(B,{className:"text-2xl font-bold pr-6",children:a.title}),e.jsxs(me,{className:"text-blue-100 mt-2",children:["Par ",a.clientName," • ",F(a.budget||"0")," • ",b.length," candidature",b.length!==1?"s":""]})]}),e.jsx("div",{className:"p-6",children:e.jsxs(he,{value:N,onValueChange:r,className:"w-full",children:[e.jsxs(pe,{className:`grid w-full ${I?"grid-cols-3":"grid-cols-2"}`,children:[e.jsxs(U,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Aperçu"]}),e.jsxs(U,{value:"bids",className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"Candidatures (",b.length,")"]}),I&&e.jsxs(U,{value:"team",className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Équipe"]})]}),e.jsxs(L,{value:"overview",className:"space-y-6 mt-6",children:[e.jsxs(p,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center",children:e.jsx(K,{className:"w-8 h-8 text-blue-600"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:a.title}),e.jsxs("p",{className:"text-gray-500",children:["Par ",e.jsx("span",{className:"font-medium text-blue-600",children:a.clientName})," • ",P(a.createdAt||new Date().toISOString())]})]}),e.jsx(w,{className:"bg-green-100 text-green-700",children:oe?.name||a.category})]})})]})}),e.jsxs(u,{children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.description})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Budget"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:F(a.budget||"0")})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ae,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Localisation"})]}),e.jsx("div",{className:"text-blue-600 font-medium",children:a.location||"Non spécifié"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(H,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Publié"})]}),e.jsx("div",{className:"text-purple-600 font-medium",children:P(a.createdAt||new Date().toISOString())})]})]})]})]}),l&&l.type==="provider"&&a.clientName!==l.name&&e.jsxs(p,{className:"border-2 border-green-200 bg-gradient-to-br from-green-50 to-emerald-50",children:[e.jsx(E,{children:e.jsxs(O,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(ie,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold",children:"Postuler à cette mission"}),e.jsx("p",{className:"text-sm text-gray-600 font-normal",children:"Soumettez votre offre avec prix et délai"})]})]})}),e.jsxs(u,{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(h,{onClick:()=>X(!$),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",size:"lg",children:"🧠 Analyser avec l'IA"}),e.jsx(h,{onClick:()=>c(!y),className:"w-full bg-primary hover:bg-primary/90",size:"lg",children:y?"Masquer le formulaire":"Soumettre une offre"})]}),$&&e.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border",children:e.jsx(Ne,{missionTitle:a.title,missionDescription:a.description,missionBudget:parseFloat(a.budget||"0"),missionCategory:a.category,currentBid:{},providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:b,onOptimizedBidGenerated:s=>{c(!0)}})}),y&&e.jsx("div",{className:"mt-6 p-6 bg-white rounded-lg border",children:e.jsx(ye,{missionId:a.id,onSuccess:()=>{c(!1),X(!1)}})})]})]}),l&&l.type==="provider"&&a.clientName===l.name&&e.jsx(p,{className:"border-2 border-blue-200 bg-blue-50",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(Y,{className:"w-5 h-5 text-white"})}),e.jsx("p",{className:"text-blue-700 font-medium",children:"Ceci est votre propre mission"})]})})})]}),e.jsxs(L,{value:"bids",className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Offres reçues (",b.length,")"]}),b.length>0&&e.jsx(w,{variant:"outline",children:"Triées par prix croissant"})]}),b.length===0?e.jsx(p,{children:e.jsxs(u,{className:"text-center py-12",children:[e.jsx(V,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune offre reçue"}),e.jsx("p",{className:"text-gray-500",children:"Les prestataires peuvent encore postuler à cette mission"})]})}):e.jsx("div",{className:"space-y-4",children:b.map((s,j)=>e.jsx(p,{className:"hover:shadow-md transition-shadow",children:e.jsxs(u,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:s.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-lg cursor-pointer hover:text-primary transition-colors",onClick:()=>{n(s.providerId),x(s.providerName)},children:s.providerName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[ce(s.rating||"5.0"),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:[parseFloat(s.rating||"5.0").toFixed(1),"/5"]})]}),j===0&&b.length>1&&e.jsx(w,{className:"bg-green-100 text-green-700",children:"Meilleure offre"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:F(s.price)}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center justify-end mt-1",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),s.timeline]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg p-4 mb-4 border-l-4 border-blue-400",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-line leading-relaxed",children:s.proposal})}),l&&a.userName===l.name&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(h,{onClick:()=>{g(s.id),q(s.providerName)},variant:"outline",className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"Répondre"]}),e.jsxs(h,{className:"bg-green-500 hover:bg-green-600 text-white flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Accepter l'offre"]})]})]})},s.id))})]}),I&&e.jsxs(L,{value:"team",className:"space-y-6 mt-6",children:[e.jsxs(p,{children:[e.jsx(E,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Composition de l'équipe requise"]})}),e.jsx(u,{children:e.jsx("div",{className:"grid gap-4",children:a.teamRequirements?.map((s,j)=>e.jsx(p,{className:"border-l-4 border-l-blue-500",children:e.jsxs(u,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.role}),e.jsx("p",{className:"text-gray-600",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:F(s.budget||"0")}),e.jsxs(w,{variant:"outline",children:[s.quantity," personne",s.quantity>1?"s":""]})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Compétences requises :"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.skills.map((k,D)=>e.jsx(w,{variant:"secondary",className:"text-xs",children:k},D))})]})]})},j))})})]}),l&&l.type==="provider"&&a.clientName!==l.name&&e.jsxs(p,{className:"border-2 border-orange-200 bg-gradient-to-br from-orange-50 to-yellow-50",children:[e.jsx(E,{children:e.jsxs(O,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-500 to-yellow-600 rounded-xl flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold",children:"Candidature d'équipe"}),e.jsx("p",{className:"text-sm text-gray-600 font-normal",children:"Postulez pour un ou plusieurs rôles"})]})]})}),e.jsx(u,{children:e.jsx("p",{className:"text-center text-gray-600 py-4",children:"Fonctionnalité de candidature d'équipe en cours de développement"})})]})]})]})})]}),e.jsx(we,{providerId:v,providerName:t,isOpen:!!v,onClose:()=>{n(null),x("")}}),e.jsx(Ce,{bidId:i,bidderName:C,isOpen:!!i,onClose:()=>{g(null),q("")}})]})}export{He as M};
