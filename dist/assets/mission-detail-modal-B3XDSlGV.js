import{r as g,j as e}from"./ui-BW6CElO3.js";import{u as H}from"./useQuery-B6l3XhT9.js";import{d as V,e as O,f as _,g as G,L as P,I as K,B as p,h as W,D as y,i as w,j as C,k as S,V as te,l as E,C as I,b as k,m as $,U as Q}from"./index-TuFgUwjO.js";import{a as F,g as ae,f as z}from"./categories-DUi1-GTl.js";import{T as X}from"./textarea-C4PILcZC.js";import{B as M}from"./badge-MEukVGIV.js";import{L as le}from"./lucide-react-CTASJnOs.js";import{A as ie}from"./availability-calendar-C5NO4qlT.js";import{M as J}from"./map-pin-B9sU7Us2.js";import{C as R}from"./calendar-Cizqb4AE.js";import{M as T}from"./message-circle-tG-WkBGo.js";import{P as ne}from"./phone-C2AAHMbK.js";import{C as oe}from"./clock-DiAQToei.js";import{A as ce}from"./award-BxkgEywy.js";import{S as Y}from"./star-CsNwvggj.js";import{C as de}from"./circle-check-big-CLibHLAg.js";import{C as me}from"./circle-x-DO00_p4x.js";import{S as xe}from"./smart-bid-analyzer-BHypHMCO.js";import{E as pe}from"./euro-pQOtZYMl.js";function ue({missionId:x,onSuccess:d}){const{user:o}=V(),{toast:n}=O(),u=_(),[s,j]=g.useState({price:"",timeline:"",proposal:""}),i=G({mutationFn:async a=>(await W("POST","/api/bids",a)).json(),onSuccess:()=>{u.invalidateQueries({queryKey:["/api/missions",x]}),u.invalidateQueries({queryKey:["/api/missions"]}),u.invalidateQueries({queryKey:["/api/users",o?.id,"bids"]}),n({title:"Offre envoyée !",description:"Votre offre a été envoyée avec succès"}),j({price:"",timeline:"",proposal:""}),d()},onError:a=>{n({title:"Erreur",description:a.message||"Une erreur est survenue",variant:"destructive"})}}),r=a=>{if(a.preventDefault(),!s.price||!s.timeline||!s.proposal){n({title:"Champs requis",description:"Veuillez remplir tous les champs",variant:"destructive"});return}if(!o){n({title:"Connexion requise",description:"Vous devez être connecté pour postuler",variant:"destructive"});return}i.mutate({missionId:x,providerId:o.id,providerName:o.name,price:parseFloat(s.price),timeline:s.timeline,proposal:s.proposal,rating:o.rating||"5.0"})},m=(a,h)=>{j(f=>({...f,[a]:h}))};return!o||o.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{htmlFor:"price",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"💰"}),e.jsx("span",{children:"Prix proposé (€)"})]}),e.jsx(K,{id:"price",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:s.price,onChange:a=>m("price",a.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsx("span",{children:"Délai de livraison"})]}),e.jsx(K,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:s.timeline,onChange:a=>m("timeline",a.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📝"}),e.jsx("span",{children:"Décrivez votre proposition"})]}),e.jsx(X,{id:"proposal",placeholder:"Expliquez votre approche, votre expérience pertinente et ce que vous allez concrètement livrer pour cette mission...",value:s.proposal,onChange:a=>m("proposal",a.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx(p,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:i.isPending,children:i.isPending?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🚀"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function he({providerId:x,providerName:d,isOpen:o,onClose:n}){const{toast:u}=O(),{data:s,isLoading:j}=H({queryKey:["/api/providers",x,"profile"],enabled:!!x&&o}),i=r=>Array.from({length:5},(m,a)=>e.jsx(Y,{className:`w-4 h-4 ${a<r?"text-yellow-400 fill-current":"text-gray-300"}`},a));return!o||!x?null:e.jsx(y,{open:o,onOpenChange:n,children:e.jsxs(w,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(C,{children:e.jsx(S,{asChild:!0,children:e.jsx(te,{children:"Profil du prestataire"})})}),e.jsx("div",{className:"p-6"}),j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),s.location||"Localisation non spécifiée"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),"Membre depuis ",F(s.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:i(Math.round(parseFloat(s.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:s.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.totalProjects," projets réalisés"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills.map((r,m)=>e.jsx(M,{variant:"secondary",children:r},m))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(p,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${x}&name=${encodeURIComponent(d)}`},children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(p,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{u({title:"Contacter le prestataire",description:`Appelez ${d} pour discuter du projet`})},children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(p,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{u({title:"Réservation de créneau",description:`Fonctionnalité de réservation avec ${d} en cours de développement`})},children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Réserver un créneau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(E,{className:"w-5 h-5 mr-2"}),"Réalisations récentes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:s.portfolio.slice(0,4).map(r=>e.jsx(I,{children:e.jsxs(k,{className:"p-4",children:[r.images.length>0&&e.jsx("img",{src:r.images[0],alt:r.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:r.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(M,{variant:"outline",children:r.category}),e.jsx("span",{className:"text-xs text-gray-500",children:F(r.completedAt)})]})]})},r.id))}),s.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune réalisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(oe,{className:"w-5 h-5 mr-2"}),"Disponibilités"]}),e.jsx(I,{children:e.jsx(k,{className:"p-4",children:e.jsx(ie,{readOnly:!0,initialAvailability:s.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 mr-2"}),"Avis clients (",s.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.evaluations.map(r=>e.jsx(I,{children:e.jsxs(k,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[i(r.rating),e.jsx("span",{className:"ml-2 font-medium",children:r.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:F(r.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:r.comment}),r.photos&&r.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:r.photos.slice(0,3).map((m,a)=>e.jsx("img",{src:m,alt:`Photo ${a+1}`,className:"w-16 h-16 object-cover rounded-lg"},a))})]})},r.id))}),s.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{onClick:n,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvé"})})]})})}function ge({bidId:x,bidderName:d,isOpen:o,onClose:n}){const{user:u}=V(),{toast:s}=O(),j=_(),[i,r]=g.useState(null),[m,a]=g.useState(""),h=G({mutationFn:async c=>(await W("POST","/api/bids/respond",c)).json(),onSuccess:()=>{j.invalidateQueries({queryKey:["/api/missions"]});const c=i==="accept"?"acceptée":i==="reject"?"déclinée":"en négociation";s({title:"Réponse envoyée !",description:`Votre réponse (${c}) a été envoyée au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre réponse "${c}" a bien été envoyée à ${d}. Un email de confirmation lui a été envoyé.`)},500),n(),r(null),a("")},onError:c=>{s({title:"Erreur",description:c.message||"Une erreur est survenue",variant:"destructive"})}}),f=c=>{if(c.preventDefault(),!i){s({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(i==="negotiate"&&!m.trim()){s({title:"Message requis",description:"Veuillez ajouter un message pour négocier",variant:"destructive"});return}h.mutate({bidId:x,status:i,message:m.trim()||null,clientResponse:i})},N=c=>{switch(c){case"accept":return`Bonjour ${d},

Nous avons le plaisir de vous informer que votre offre a été retenue pour ce projet. Nous allons procéder à la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${d},

Nous vous remercions pour votre offre. Malheureusement, nous avons décidé de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${d},

Votre offre nous intéresse. Cependant, nous aimerions discuter de certains points :

- 
- 

Êtes-vous ouvert à la négociation ?

Cordialement`}},b=c=>{r(c),a(N(c))};return e.jsx(y,{open:o,onOpenChange:n,children:e.jsxs(w,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsx(C,{children:e.jsxs(S,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(T,{className:"w-6 h-6 text-blue-500"}),"Répondre à l'offre de ",d]})}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre réponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>b("accept"),className:`p-4 rounded-xl border-2 transition-all ${i==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(de,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>b("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${i==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(T,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"Négocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>b("reject"),className:`p-4 rounded-xl border-2 transition-all ${i==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(me,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"Décliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message à ",d]}),e.jsx(X,{id:"message",value:m,onChange:c=>a(c.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:n,className:"flex-1",disabled:h.isPending,children:"Annuler"}),e.jsx(p,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!i||h.isPending,children:h.isPending?"Envoi...":"Envoyer la réponse"})]})]})]})})}function Ee({missionId:x,isOpen:d,onClose:o}){const{user:n}=V(),[u,s]=g.useState(null),[j,i]=g.useState(""),[r,m]=g.useState(null),[a,h]=g.useState(""),[f,N]=g.useState(!1),[b,c]=g.useState(!1),[A,Z]=g.useState({}),{data:t,isLoading:ee,error:L}=H({queryKey:[`/api/missions/${x}`],enabled:!!x&&d,retry:3,retryDelay:l=>Math.min(1e3*2**l,3e4),staleTime:3e4,refetchOnWindowFocus:!1});if(ee)return e.jsx(y,{open:d,onOpenChange:o,children:e.jsxs(w,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto bg-white border-0 shadow-2xl",children:[e.jsxs(C,{children:[e.jsx(S,{children:"Chargement..."}),e.jsx($,{children:"Chargement des détails de la mission en cours..."})]}),e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Chargement des détails de la mission..."})]})]})});if(L||!t)return e.jsx(y,{open:d,onOpenChange:o,children:e.jsxs(w,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto bg-white border-0 shadow-2xl",children:[e.jsxs(C,{children:[e.jsx(S,{children:"Erreur"}),e.jsx($,{children:"Impossible de charger les détails de la mission"})]}),e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:"❌"}),e.jsx("p",{className:"text-gray-500 mb-4",children:L?"Erreur de chargement des données":"Mission non trouvée"}),e.jsx(p,{onClick:o,variant:"outline",children:"Fermer"})]})]})});const B=ae(t.category),se=B?(l=>le[l.split("-").map(D=>D.charAt(0).toUpperCase()+D.slice(1)).join("")]||E)(B.icon):E,re=l=>{const v=parseFloat(l);return Array.from({length:5},(D,U)=>e.jsx(Y,{className:`w-4 h-4 ${U<Math.floor(v)?"text-yellow-400 fill-current":"text-gray-300"}`},U))},q=[...t.bids].sort((l,v)=>parseFloat(l.price)-parseFloat(v.price));return e.jsxs(y,{open:d,onOpenChange:o,children:[e.jsxs(w,{className:"w-[96vw] max-w-4xl max-h-[92vh] overflow-y-auto p-0 bg-white border-0 shadow-2xl rounded-xl mx-2","aria-describedby":"mission-description",children:[e.jsxs(C,{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4 sm:p-6 rounded-t-xl",children:[e.jsx(S,{className:"text-lg sm:text-2xl font-bold pr-6 text-white leading-tight",children:t.title}),e.jsxs($,{className:"text-blue-100 mt-2 text-sm sm:text-base",children:["Par ",t.clientName," • ",z(t.budget||"0")," • ",t.bids.length," candidature",t.bids.length!==1?"s":""]})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-5",children:[e.jsxs("div",{className:"border-b pb-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-4 sm:space-y-0 sm:space-x-4 mb-5",children:[e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center shadow-lg mx-auto sm:mx-0",children:e.jsx(se,{className:`w-7 h-7 sm:w-8 sm:h-8 ${B?.color||"text-blue-600"}`})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t.title}),e.jsx(M,{className:"bg-green-100 text-green-700 border-green-200 self-center sm:self-start",children:B?.name||t.category})]}),e.jsxs("p",{className:"text-gray-500 mb-3 text-sm",children:["Publié par ",e.jsx("span",{className:"font-medium text-blue-600",children:t.clientName})," • ",F(t.createdAt)]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-700 leading-relaxed text-sm sm:text-base",children:t.description})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(pe,{className:"w-5 h-5 text-green-600 mr-2"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Budget"})]}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:z(t.budget||"0")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(J,{className:"w-4 h-4 text-blue-600 mr-2"}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Localisation"})]}),e.jsx("div",{className:"text-blue-600 font-medium text-sm",children:t.location||"Non spécifié"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Q,{className:"w-4 h-4 text-purple-600 mr-2"}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:"Candidatures"})]}),e.jsx("div",{className:"text-lg font-bold text-purple-600",children:t.bids.length})]})]})]})]}),n&&n.type==="provider"&&t.clientName!==n.name&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4 border-2 border-green-200 shadow-md mb-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg mx-auto sm:mx-0",children:e.jsx("span",{className:"text-white font-bold text-xl",children:"💼"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Postuler à cette mission"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Soumettez votre offre avec prix et délai"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(p,{onClick:()=>N(!f),className:"w-full bg-primary hover:bg-primary/90 py-3 text-base",size:"lg",children:f?"Masquer le formulaire":"Soumettre une offre"}),e.jsx(p,{onClick:()=>c(!b),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 py-3 text-base",size:"lg",children:"🧠 Analyser avec l'IA"})]}),b&&e.jsx("div",{className:"mt-6",children:e.jsx(xe,{missionTitle:t.title,missionDescription:t.description,missionBudget:parseFloat(t.budget||"0"),missionCategory:t.category,currentBid:A,providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:t.bids,onOptimizedBidGenerated:l=>{Z(l),N(!0)}})}),f&&e.jsx("div",{className:"mt-6 p-6 bg-gray-50 rounded-lg border",children:e.jsx(ue,{missionId:t.id,onSuccess:()=>{N(!1),c(!1)},initialValues:A.proposal?A:void 0})})]})]}),n&&n.type==="provider"&&t.clientName===n.name&&e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"ℹ️"})}),e.jsx("p",{className:"text-blue-700 font-medium",children:"Ceci est votre propre mission"})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-5",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Offres reçues (",t.bids.length,")"]}),q.length>0&&e.jsx("div",{className:"text-sm text-gray-500",children:"Triées par prix croissant"})]}),e.jsxs("div",{className:"space-y-4",children:[q.map((l,v)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:l.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 cursor-pointer hover:text-primary transition-colors text-base",onClick:()=>{s(l.providerId),i(l.providerName)},children:l.providerName}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center",children:[re(l.rating||"5.0"),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:[parseFloat(l.rating||"5.0").toFixed(1),"/5"]})]}),v===0&&q.length>1&&e.jsx(M,{className:"bg-green-100 text-green-700 text-xs w-fit",children:"Meilleure offre"})]})]})]})}),e.jsxs("div",{className:"text-center sm:text-right border-l sm:border-l-0 border-t sm:border-t-0 sm:border-l border-gray-200 pl-4 sm:pl-0 pt-4 sm:pt-0 sm:pl-4",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:z(l.price)}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center justify-center sm:justify-end mt-1",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),l.timeline]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg p-4 mb-4 border-l-4 border-blue-400",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-line leading-relaxed text-sm sm:text-base",children:l.proposal})}),n&&t.clientName===n.name&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(p,{onClick:()=>{m(l.id),h(l.providerName)},variant:"outline",className:"w-full sm:w-auto border-blue-500 text-blue-600 hover:bg-blue-50 font-semibold flex items-center justify-center gap-2 py-2",children:"💬 Répondre"}),e.jsx(p,{className:"w-full sm:w-auto bg-green-500 hover:bg-green-600 text-white font-semibold flex items-center justify-center gap-2 py-2",children:"✅ Accepter l'offre"})]})]},l.id)),t.bids.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Q,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Aucune offre reçue pour le moment"})]})]})]})]})]}),e.jsx(he,{providerId:u,providerName:j,isOpen:!!u,onClose:()=>{s(null),i("")}}),e.jsx(ge,{bidId:r,bidderName:a,isOpen:!!r,onClose:()=>{m(null),h("")}})]})}export{Ee as M};
